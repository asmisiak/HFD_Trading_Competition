<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Team members: Joanna Misiak and Agata Tomaszewska">

<title>Quantitative strategies on High Frequency Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="final_report (1)_files/libs/clipboard/clipboard.min.js"></script>
<script src="final_report (1)_files/libs/quarto-html/quarto.js"></script>
<script src="final_report (1)_files/libs/quarto-html/popper.min.js"></script>
<script src="final_report (1)_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="final_report (1)_files/libs/quarto-html/anchor.min.js"></script>
<link href="final_report (1)_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="final_report (1)_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="final_report (1)_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="final_report (1)_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="final_report (1)_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Quantitative strategies on High Frequency Data</h1>
<p class="subtitle lead">submission of research project</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Team members: Joanna Misiak and Agata Tomaszewska </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Jan 20, 2026</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="approaches-undertaken" class="level2 center">
<h2 class="center anchored" data-anchor-id="approaches-undertaken">Approaches undertaken</h2>
<p>To find the best strategy we considered:<br>
- two intersecting moving averages<br>
- a single moving average and a selected volatility measure<br>
For each approach we considered a trend following and mean reverting strategy. We tried pair-trading (both based on prices and returns) and portfolio based on the assets volatility. <strong>However, the best results were obtained with single asset trading.</strong></p>
<p>We considered several combinations of parameters:<br>
- slow and fast EMAs for two intersecting moving averages<br>
- signal and slow EMAs for volatility breakout strategies<br>
- volatilities and multipliers of the lower-upper thresholds for VB.</p>
</section>
<section id="approaches-undertaken-contd" class="level2">
<h2 class="anchored" data-anchor-id="approaches-undertaken-contd">Approaches undertaken (cont’d)</h2>
<p>For pair trading attempt, addtional filtering was applied. Filters based on correlation, cointegration and regression were applied, but none of them improved the overall results.</p>
<p>For the final, single asset trades, <strong>stop-loss condition</strong> was added. If the cumulative PnL for the day was lower than $500 and $1000, for group 1 and 2 respectively, trades for the day were stopped.</p>
<p>To find the best strategy, we looked at the <strong>sum of the final statistic for each quarter.</strong></p>
</section>
<section id="data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis">Data analysis</h2>
<p>After the initial data preparation and cleaning, we conducted an analysis to determine the most suitable structure for the trading strategy. We examined whether better results could be achieved by trading a single asset, constructing a spread between assets, or building a multi-asset portfolio. The analyses performed are presented below.</p>
<p>We begin our analysis with data from group 1, which includes two assets: SP and NQ</p>
<section id="individual-assets" class="level3">
<h3 class="anchored" data-anchor-id="individual-assets">Individual assets</h3>
<div class="cell" data-execution_count="2">
<div class="cell-output cell-output-display" data-execution_count="2">

<style type="text/css">
#T_b934b_row0_col0 {
  background-color: #f5f6f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_b934b_row0_col1, #T_b934b_row3_col0, #T_b934b_row4_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_b934b_row1_col0, #T_b934b_row1_col1 {
  background-color: #f8f4f2;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_b934b_row2_col0 {
  background-color: #f8f3f0;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_b934b_row2_col1 {
  background-color: #f8f2ef;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_b934b_row3_col1, #T_b934b_row4_col1 {
  background-color: #f7f6f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_b934b_row5_col0, #T_b934b_row5_col1, #T_b934b_row6_col0 {
  background-color: #f7f5f4;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_b934b_row6_col1 {
  background-color: #f2f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_b934b">
  <thead>
    <tr>
      <th id="T_b934b_level0_col0" class="col_heading level0 col0">NQ</th>
      <th id="T_b934b_level0_col1" class="col_heading level0 col1">SP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_b934b_row0_col0" class="data row0 col0">+0.01102</td>
      <td id="T_b934b_row0_col1" class="data row0 col1">+0.00754</td>
    </tr>
    <tr>
      <td id="T_b934b_row1_col0" class="data row1 col0">-0.01564</td>
      <td id="T_b934b_row1_col1" class="data row1 col1">-0.01678</td>
    </tr>
    <tr>
      <td id="T_b934b_row2_col0" class="data row2 col0">-0.02810</td>
      <td id="T_b934b_row2_col1" class="data row2 col1">-0.03695</td>
    </tr>
    <tr>
      <td id="T_b934b_row3_col0" class="data row3 col0">+0.00603</td>
      <td id="T_b934b_row3_col1" class="data row3 col1">-0.00190</td>
    </tr>
    <tr>
      <td id="T_b934b_row4_col0" class="data row4 col0">+0.00080</td>
      <td id="T_b934b_row4_col1" class="data row4 col1">-0.00481</td>
    </tr>
    <tr>
      <td id="T_b934b_row5_col0" class="data row5 col0">-0.01052</td>
      <td id="T_b934b_row5_col1" class="data row5 col1">-0.01031</td>
    </tr>
    <tr>
      <td id="T_b934b_row6_col0" class="data row6 col0">-0.01006</td>
      <td id="T_b934b_row6_col1" class="data row6 col1">+0.02978</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The individual assets show small and mixed average returns, with no clear or consistent profitability across periods. This suggests that standalone single-asset strategies do not exhibit a strong or robust edge.</p>
</section>
<section id="lets-analyze-the-stability-of-the-autocorrelations" class="level3">
<h3 class="anchored" data-anchor-id="lets-analyze-the-stability-of-the-autocorrelations">Let’s analyze the stability of the autocorrelations</h3>
<div class="cell" data-execution_count="3">
<div class="cell-output cell-output-display" data-execution_count="3">

<style type="text/css">
#T_9025c_row0_col0, #T_9025c_row1_col0 {
  background-color: #f7f6f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_9025c_row0_col1 {
  background-color: #f5f6f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_9025c_row0_col2 {
  background-color: #4c99c6;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_9025c_row0_col3 {
  background-color: #87beda;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_9025c_row1_col1 {
  background-color: #f3f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_9025c_row1_col2 {
  background-color: #2f79b5;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_9025c_row1_col3 {
  background-color: #b6d7e8;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_9025c">
  <thead>
    <tr>
      <th id="T_9025c_level0_col0" class="col_heading level0 col0">mean_autocorr</th>
      <th id="T_9025c_level0_col1" class="col_heading level0 col1">std_autocorr</th>
      <th id="T_9025c_level0_col2" class="col_heading level0 col2">negative_ratio</th>
      <th id="T_9025c_level0_col3" class="col_heading level0 col3">positive_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_9025c_row0_col0" class="data row0 col0">-0.00664</td>
      <td id="T_9025c_row0_col1" class="data row0 col1">+0.01352</td>
      <td id="T_9025c_row0_col2" class="data row0 col2">+0.57143</td>
      <td id="T_9025c_row0_col3" class="data row0 col3">+0.42857</td>
    </tr>
    <tr>
      <td id="T_9025c_row1_col0" class="data row1 col0">-0.00477</td>
      <td id="T_9025c_row1_col1" class="data row1 col1">+0.02067</td>
      <td id="T_9025c_row1_col2" class="data row1 col2">+0.71429</td>
      <td id="T_9025c_row1_col3" class="data row1 col3">+0.28571</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>Autocorrelations are close to zero on average and display moderate variability over time. Although negative autocorrelation dominates slightly, the lack of strong and stable autocorrelation indicates limited predictability at the single-asset level.</p>
</section>
<section id="lets-analyze-the-average-volatility-of-the-assets" class="level3">
<h3 class="anchored" data-anchor-id="lets-analyze-the-average-volatility-of-the-assets">Let’s analyze the average volatility of the assets</h3>
<div class="cell" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="4">

<style type="text/css">
#T_77ba2_row0_col0, #T_77ba2_row1_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_77ba2">
  <thead>
    <tr>
      <th id="T_77ba2_level0_col0" class="col_heading level0 col0">avg_volatility</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_77ba2_row0_col0" class="data row0 col0">+0.00049</td>
    </tr>
    <tr>
      <td id="T_77ba2_row1_col0" class="data row1 col0">+0.00038</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>Both assets exhibit relatively low and comparable average volatility. This implies limited return dispersion, which further constrains the potential profitability of simple directional strategies.</p>
</section>
<section id="conclusions-for-trading-single-assets" class="level3">
<h3 class="anchored" data-anchor-id="conclusions-for-trading-single-assets">Conclusions for trading single assets</h3>
<p>Overall, the analysis suggests that trading single assets individually is unlikely to deliver stable and attractive performance. This motivates exploring alternative structures such as spreads or multi-asset portfolios to improve robustness and exploit relative dynamics.</p>
</section>
<section id="spread" class="level3">
<h3 class="anchored" data-anchor-id="spread">Spread</h3>
<div class="cell" data-execution_count="5">
<div class="cell-output cell-output-display" data-execution_count="5">

<style type="text/css">
#T_c58f1_row0_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c58f1_row1_col0, #T_c58f1_row3_col0 {
  background-color: #f7f5f4;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c58f1_row2_col0 {
  background-color: #f8f2ef;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c58f1_row4_col0 {
  background-color: #f8f3f0;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c58f1_row5_col0 {
  background-color: #f8f1ed;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c58f1_row6_col0 {
  background-color: #f6af8e;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_c58f1">
  <thead>
    <tr>
      <th id="T_c58f1_level0_col0" class="col_heading level0 col0">NQ-SP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_c58f1_row0_col0" class="data row0 col0">+0.00343</td>
    </tr>
    <tr>
      <td id="T_c58f1_row1_col0" class="data row1 col0">-0.01225</td>
    </tr>
    <tr>
      <td id="T_c58f1_row2_col0" class="data row2 col0">-0.03726</td>
    </tr>
    <tr>
      <td id="T_c58f1_row3_col0" class="data row3 col0">-0.01516</td>
    </tr>
    <tr>
      <td id="T_c58f1_row4_col0" class="data row4 col0">-0.02896</td>
    </tr>
    <tr>
      <td id="T_c58f1_row5_col0" class="data row5 col0">-0.04261</td>
    </tr>
    <tr>
      <td id="T_c58f1_row6_col0" class="data row6 col0">-0.36538</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The NQ–SP spread exhibits predominantly negative returns, with occasional larger drawdowns. This indicates that the raw spread, traded directionally, does not provide a consistent standalone profitability.</p>
</section>
<section id="spread-stability" class="level3">
<h3 class="anchored" data-anchor-id="spread-stability">Spread stability</h3>
<div class="cell" data-execution_count="6">
<div class="cell-output cell-output-display" data-execution_count="6">

<style type="text/css">
#T_f0f9e_row0_col0 {
  background-color: #f9ede5;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f0f9e_row0_col1 {
  background-color: #195696;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_f0f9e_row0_col2 {
  background-color: #dbeaf2;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f0f9e_row0_col3 {
  background-color: #deebf2;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_f0f9e">
  <thead>
    <tr>
      <th id="T_f0f9e_level0_col0" class="col_heading level0 col0">mean_autocorr</th>
      <th id="T_f0f9e_level0_col1" class="col_heading level0 col1">negative_ratio</th>
      <th id="T_f0f9e_level0_col2" class="col_heading level0 col2">positive_ratio</th>
      <th id="T_f0f9e_level0_col3" class="col_heading level0 col3">std_autocorr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_f0f9e_row0_col0" class="data row0 col0">-0.07117</td>
      <td id="T_f0f9e_row0_col1" class="data row0 col1">+0.85714</td>
      <td id="T_f0f9e_row0_col2" class="data row0 col2">+0.14286</td>
      <td id="T_f0f9e_row0_col3" class="data row0 col3">+0.13069</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The spread shows a clearly negative average autocorrelation with a high proportion of negative observations, suggesting mean-reverting behavior. This indicates better structural properties than single-asset autocorrelations.</p>
</section>
<section id="spread-volatility" class="level3">
<h3 class="anchored" data-anchor-id="spread-volatility">Spread volatility</h3>
<div class="cell" data-execution_count="7">
<div class="cell-output cell-output-display" data-execution_count="7">

<style type="text/css">
#T_c8ab8_row0_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_c8ab8">
  <thead>
    <tr>
      <th id="T_c8ab8_level0_col0" class="col_heading level0 col0">avg_volatility</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_c8ab8_row0_col0" class="data row0 col0">+0.00023</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The average volatility of the spread is lower than that of the individual assets, reflecting diversification effects and improved risk characteristics.</p>
</section>
<section id="conclusions-for-spread" class="level3">
<h3 class="anchored" data-anchor-id="conclusions-for-spread">Conclusions for spread</h3>
<p>Compared to single-asset strategies, the spread demonstrates more stable statistical properties and lower volatility, making it a more promising candidate for further strategy development, particularly for mean-reversion-based approaches.</p>
</section>
<section id="portfolio" class="level3">
<h3 class="anchored" data-anchor-id="portfolio">Portfolio</h3>
<div class="cell" data-execution_count="8">
<div class="cell-output cell-output-display" data-execution_count="8">

<style type="text/css">
#T_4040b_row0_col0 {
  background-color: #f5f6f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_4040b_row1_col0 {
  background-color: #f8f4f2;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_4040b_row2_col0 {
  background-color: #f8f3f0;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_4040b_row3_col0, #T_4040b_row4_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_4040b_row5_col0 {
  background-color: #f7f5f4;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_4040b_row6_col0 {
  background-color: #f3f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_4040b">
  <thead>
    <tr>
      <th id="T_4040b_level0_col0" class="col_heading level0 col0">Index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_4040b_row0_col0" class="data row0 col0">+0.01101</td>
    </tr>
    <tr>
      <td id="T_4040b_row1_col0" class="data row1 col0">-0.01664</td>
    </tr>
    <tr>
      <td id="T_4040b_row2_col0" class="data row2 col0">-0.03108</td>
    </tr>
    <tr>
      <td id="T_4040b_row3_col0" class="data row3 col0">+0.00405</td>
    </tr>
    <tr>
      <td id="T_4040b_row4_col0" class="data row4 col0">+0.00124</td>
    </tr>
    <tr>
      <td id="T_4040b_row5_col0" class="data row5 col0">-0.00912</td>
    </tr>
    <tr>
      <td id="T_4040b_row6_col0" class="data row6 col0">+0.01840</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The portfolio delivers small but consistently positive returns across periods, indicating improved performance compared to single-asset and spread strategies.</p>
</section>
<section id="portfolio-stability" class="level3">
<h3 class="anchored" data-anchor-id="portfolio-stability">Portfolio stability</h3>
<div class="cell" data-execution_count="9">
<div class="cell-output cell-output-display" data-execution_count="9">

<style type="text/css">
#T_e867f_row0_col0 {
  background-color: #f7f6f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_e867f_row0_col1 {
  background-color: #87beda;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_e867f_row0_col2 {
  background-color: #4c99c6;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_e867f_row0_col3 {
  background-color: #f3f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_e867f">
  <thead>
    <tr>
      <th id="T_e867f_level0_col0" class="col_heading level0 col0">mean_autocorr</th>
      <th id="T_e867f_level0_col1" class="col_heading level0 col1">negative_ratio</th>
      <th id="T_e867f_level0_col2" class="col_heading level0 col2">positive_ratio</th>
      <th id="T_e867f_level0_col3" class="col_heading level0 col3">std_autocorr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_e867f_row0_col0" class="data row0 col0">-0.00316</td>
      <td id="T_e867f_row0_col1" class="data row0 col1">+0.42857</td>
      <td id="T_e867f_row0_col2" class="data row0 col2">+0.57143</td>
      <td id="T_e867f_row0_col3" class="data row0 col3">+0.01700</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>Autocorrelations are close to zero on average, with a balanced distribution between positive and negative values. This suggests stable behavior without strong directional or mean-reverting bias.</p>
</section>
<section id="portfolio-volatility" class="level3">
<h3 class="anchored" data-anchor-id="portfolio-volatility">Portfolio volatility</h3>
<div class="cell" data-execution_count="10">
<div class="cell-output cell-output-display" data-execution_count="10">

<style type="text/css">
#T_040fa_row0_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_040fa">
  <thead>
    <tr>
      <th id="T_040fa_level0_col0" class="col_heading level0 col0">avg_volatility</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_040fa_row0_col0" class="data row0 col0">+0.00042</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The portfolio exhibits the lowest average volatility among the analyzed structures, reflecting effective diversification and improved risk-adjusted characteristics.</p>
</section>
<section id="conlusions-for-portfolio" class="level3">
<h3 class="anchored" data-anchor-id="conlusions-for-portfolio">Conlusions for portfolio</h3>
<p>The portfolio structure provides the most stable and robust profile, combining positive average performance with low volatility. This makes it the most attractive candidate for further strategy development and optimization.</p>
</section>
<section id="final-conclusion" class="level3">
<h3 class="anchored" data-anchor-id="final-conclusion">Final conclusion</h3>
<p>Based on the first analysis, the portfolio approach offers the most robust and reliable framework for strategy development and is therefore the preferred choice over single-asset and spread-based strategies.</p>
</section>
</section>
<section id="second-group-of-assets" class="level2">
<h2 class="anchored" data-anchor-id="second-group-of-assets">Second group of assets</h2>
<p>Now we can move on to analyzing the second group of assets consisting of AUD, CAD, XAU, and XAG.</p>
<section id="individual-assets-1" class="level3">
<h3 class="anchored" data-anchor-id="individual-assets-1">Individual assets</h3>
<div class="cell" data-execution_count="12">
<div class="cell-output cell-output-display" data-execution_count="12">

<style type="text/css">
#T_f6413_row0_col0, #T_f6413_row3_col2, #T_f6413_row5_col0, #T_f6413_row5_col3, #T_f6413_row6_col1 {
  background-color: #f8f4f2;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f6413_row0_col1, #T_f6413_row2_col1, #T_f6413_row2_col3 {
  background-color: #f8f3f0;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f6413_row0_col2, #T_f6413_row1_col3, #T_f6413_row4_col2, #T_f6413_row4_col3 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f6413_row0_col3 {
  background-color: #f8f1ed;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f6413_row1_col0, #T_f6413_row1_col2, #T_f6413_row2_col0, #T_f6413_row3_col1, #T_f6413_row3_col3 {
  background-color: #f7f5f4;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f6413_row1_col1, #T_f6413_row5_col2, #T_f6413_row6_col2 {
  background-color: #f5f6f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f6413_row2_col2 {
  background-color: #f0f4f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f6413_row3_col0, #T_f6413_row4_col0, #T_f6413_row6_col0 {
  background-color: #f7f6f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f6413_row4_col1 {
  background-color: #edf2f5;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f6413_row5_col1 {
  background-color: #f9f0eb;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_f6413_row6_col3 {
  background-color: #f2f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_f6413">
  <thead>
    <tr>
      <th id="T_f6413_level0_col0" class="col_heading level0 col0">AUD</th>
      <th id="T_f6413_level0_col1" class="col_heading level0 col1">CAD</th>
      <th id="T_f6413_level0_col2" class="col_heading level0 col2">XAU</th>
      <th id="T_f6413_level0_col3" class="col_heading level0 col3">XAG</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_f6413_row0_col0" class="data row0 col0">-0.02249</td>
      <td id="T_f6413_row0_col1" class="data row0 col1">-0.02583</td>
      <td id="T_f6413_row0_col2" class="data row0 col2">+0.00350</td>
      <td id="T_f6413_row0_col3" class="data row0 col3">-0.04674</td>
    </tr>
    <tr>
      <td id="T_f6413_row1_col0" class="data row1 col0">-0.01020</td>
      <td id="T_f6413_row1_col1" class="data row1 col1">+0.01147</td>
      <td id="T_f6413_row1_col2" class="data row1 col2">-0.00832</td>
      <td id="T_f6413_row1_col3" class="data row1 col3">+0.00478</td>
    </tr>
    <tr>
      <td id="T_f6413_row2_col0" class="data row2 col0">-0.00816</td>
      <td id="T_f6413_row2_col1" class="data row2 col1">-0.02465</td>
      <td id="T_f6413_row2_col2" class="data row2 col2">+0.03802</td>
      <td id="T_f6413_row2_col3" class="data row2 col3">-0.02585</td>
    </tr>
    <tr>
      <td id="T_f6413_row3_col0" class="data row3 col0">-0.00343</td>
      <td id="T_f6413_row3_col1" class="data row3 col1">-0.01539</td>
      <td id="T_f6413_row3_col2" class="data row3 col2">-0.01753</td>
      <td id="T_f6413_row3_col3" class="data row3 col3">-0.01445</td>
    </tr>
    <tr>
      <td id="T_f6413_row4_col0" class="data row4 col0">-0.00169</td>
      <td id="T_f6413_row4_col1" class="data row4 col1">+0.05045</td>
      <td id="T_f6413_row4_col2" class="data row4 col2">+0.00543</td>
      <td id="T_f6413_row4_col3" class="data row4 col3">+0.00660</td>
    </tr>
    <tr>
      <td id="T_f6413_row5_col0" class="data row5 col0">-0.02290</td>
      <td id="T_f6413_row5_col1" class="data row5 col1">-0.04863</td>
      <td id="T_f6413_row5_col2" class="data row5 col2">+0.01243</td>
      <td id="T_f6413_row5_col3" class="data row5 col3">-0.02269</td>
    </tr>
    <tr>
      <td id="T_f6413_row6_col0" class="data row6 col0">-0.00251</td>
      <td id="T_f6413_row6_col1" class="data row6 col1">-0.01833</td>
      <td id="T_f6413_row6_col2" class="data row6 col2">+0.01155</td>
      <td id="T_f6413_row6_col3" class="data row6 col3">+0.02383</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>Individual assets (AUD, CAD, XAU, XAG) exhibit mixed and generally small returns, with no clear or consistent profitability across periods. This indicates a lack of a robust standalone trading edge at the single-asset level.</p>
</section>
<section id="lets-analyze-the-stability-of-the-autocorrelations-1" class="level3">
<h3 class="anchored" data-anchor-id="lets-analyze-the-stability-of-the-autocorrelations-1">Let’s analyze the stability of the autocorrelations</h3>
<div class="cell" data-execution_count="13">
<div class="cell-output cell-output-display" data-execution_count="13">

<style type="text/css">
#T_db0dc_row0_col0, #T_db0dc_row1_col0, #T_db0dc_row3_col0 {
  background-color: #f7f5f4;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_db0dc_row0_col1 {
  background-color: #f5f6f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_db0dc_row0_col2 {
  background-color: #053061;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_db0dc_row0_col3, #T_db0dc_row2_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_db0dc_row1_col1 {
  background-color: #f0f4f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_db0dc_row1_col2, #T_db0dc_row2_col3 {
  background-color: #2f79b5;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_db0dc_row1_col3, #T_db0dc_row2_col2 {
  background-color: #b6d7e8;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_db0dc_row2_col1 {
  background-color: #f3f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_db0dc_row3_col1 {
  background-color: #f2f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_db0dc_row3_col2 {
  background-color: #4c99c6;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_db0dc_row3_col3 {
  background-color: #87beda;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_db0dc">
  <thead>
    <tr>
      <th id="T_db0dc_level0_col0" class="col_heading level0 col0">mean_autocorr</th>
      <th id="T_db0dc_level0_col1" class="col_heading level0 col1">std_autocorr</th>
      <th id="T_db0dc_level0_col2" class="col_heading level0 col2">negative_ratio</th>
      <th id="T_db0dc_level0_col3" class="col_heading level0 col3">positive_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_db0dc_row0_col0" class="data row0 col0">-0.01020</td>
      <td id="T_db0dc_row0_col1" class="data row0 col1">+0.00907</td>
      <td id="T_db0dc_row0_col2" class="data row0 col2">+1.00000</td>
      <td id="T_db0dc_row0_col3" class="data row0 col3">+0.00000</td>
    </tr>
    <tr>
      <td id="T_db0dc_row1_col0" class="data row1 col0">-0.01013</td>
      <td id="T_db0dc_row1_col1" class="data row1 col1">+0.03207</td>
      <td id="T_db0dc_row1_col2" class="data row1 col2">+0.71429</td>
      <td id="T_db0dc_row1_col3" class="data row1 col3">+0.28571</td>
    </tr>
    <tr>
      <td id="T_db0dc_row2_col0" class="data row2 col0">+0.00644</td>
      <td id="T_db0dc_row2_col1" class="data row2 col1">+0.01761</td>
      <td id="T_db0dc_row2_col2" class="data row2 col2">+0.28571</td>
      <td id="T_db0dc_row2_col3" class="data row2 col3">+0.71429</td>
    </tr>
    <tr>
      <td id="T_db0dc_row3_col0" class="data row3 col0">-0.01065</td>
      <td id="T_db0dc_row3_col1" class="data row3 col1">+0.02387</td>
      <td id="T_db0dc_row3_col2" class="data row3 col2">+0.57143</td>
      <td id="T_db0dc_row3_col3" class="data row3 col3">+0.42857</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>Autocorrelations are on average slightly negative, with a high proportion of negative observations for several assets. This suggests mild mean-reverting tendencies, although the strength and consistency vary across instruments.</p>
</section>
<section id="lets-analyze-the-average-volatility-of-the-assets-1" class="level3">
<h3 class="anchored" data-anchor-id="lets-analyze-the-average-volatility-of-the-assets-1">Let’s analyze the average volatility of the assets</h3>
<div class="cell" data-execution_count="14">
<div class="cell-output cell-output-display" data-execution_count="14">

<style type="text/css">
#T_8ad19_row0_col0, #T_8ad19_row1_col0, #T_8ad19_row2_col0, #T_8ad19_row3_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_8ad19">
  <thead>
    <tr>
      <th id="T_8ad19_level0_col0" class="col_heading level0 col0">avg_volatility</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_8ad19_row0_col0" class="data row0 col0">+0.00041</td>
    </tr>
    <tr>
      <td id="T_8ad19_row1_col0" class="data row1 col0">+0.00025</td>
    </tr>
    <tr>
      <td id="T_8ad19_row2_col0" class="data row2 col0">+0.00055</td>
    </tr>
    <tr>
      <td id="T_8ad19_row3_col0" class="data row3 col0">+0.00108</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The assets display relatively low but heterogeneous volatility levels. Precious metals show higher volatility compared to FX pairs, which may offer more opportunity but also higher risk.</p>
</section>
<section id="conclusions-on-trading-individual" class="level3">
<h3 class="anchored" data-anchor-id="conclusions-on-trading-individual">Conclusions on trading individual</h3>
<p>Overall, trading individual assets does not provide a stable or reliable performance profile. While some mean-reversion signals are present, their inconsistency suggests that more structured approaches, such as spreads or portfolios, are likely to be more effective.</p>
</section>
<section id="spread-1" class="level3">
<h3 class="anchored" data-anchor-id="spread-1">Spread</h3>
<div class="cell" data-execution_count="15">
<div class="cell-output cell-output-display" data-execution_count="15">

<style type="text/css">
#T_bf5fc_row0_col0 {
  background-color: #f9ede5;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_bf5fc_row0_col1, #T_bf5fc_row2_col0 {
  background-color: #f8f2ef;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_bf5fc_row1_col0, #T_bf5fc_row2_col1, #T_bf5fc_row4_col0, #T_bf5fc_row4_col1 {
  background-color: #f7f5f4;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_bf5fc_row1_col1 {
  background-color: #f7f6f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_bf5fc_row3_col0, #T_bf5fc_row6_col1 {
  background-color: #f8f3f0;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_bf5fc_row3_col1 {
  background-color: #f8f4f2;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_bf5fc_row5_col0 {
  background-color: #f9f0eb;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_bf5fc_row5_col1 {
  background-color: #f9eee7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_bf5fc_row6_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_bf5fc">
  <thead>
    <tr>
      <th id="T_bf5fc_level0_col0" class="col_heading level0 col0">XAU-XAG</th>
      <th id="T_bf5fc_level0_col1" class="col_heading level0 col1">AUD-CAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_bf5fc_row0_col0" class="data row0 col0">-0.07544</td>
      <td id="T_bf5fc_row0_col1" class="data row0 col1">-0.03545</td>
    </tr>
    <tr>
      <td id="T_bf5fc_row1_col0" class="data row1 col0">-0.01364</td>
      <td id="T_bf5fc_row1_col1" class="data row1 col1">-0.00468</td>
    </tr>
    <tr>
      <td id="T_bf5fc_row2_col0" class="data row2 col0">-0.03264</td>
      <td id="T_bf5fc_row2_col1" class="data row2 col1">-0.01212</td>
    </tr>
    <tr>
      <td id="T_bf5fc_row3_col0" class="data row3 col0">-0.02407</td>
      <td id="T_bf5fc_row3_col1" class="data row3 col1">-0.01732</td>
    </tr>
    <tr>
      <td id="T_bf5fc_row4_col0" class="data row4 col0">-0.01350</td>
      <td id="T_bf5fc_row4_col1" class="data row4 col1">-0.01344</td>
    </tr>
    <tr>
      <td id="T_bf5fc_row5_col0" class="data row5 col0">-0.04953</td>
      <td id="T_bf5fc_row5_col1" class="data row5 col1">-0.06713</td>
    </tr>
    <tr>
      <td id="T_bf5fc_row6_col0" class="data row6 col0">+0.00753</td>
      <td id="T_bf5fc_row6_col1" class="data row6 col1">-0.02464</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>Both spreads exhibit predominantly negative returns, indicating that a simple directional spread strategy does not generate consistent profitability over time.</p>
</section>
<section id="spread-stability-1" class="level3">
<h3 class="anchored" data-anchor-id="spread-stability-1">Spread stability</h3>
<div class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="16">

<style type="text/css">
#T_0ad4d_row0_col0, #T_0ad4d_row1_col0 {
  background-color: #f8f3f0;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_0ad4d_row0_col1 {
  background-color: #f2f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_0ad4d_row0_col2 {
  background-color: #195696;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_0ad4d_row0_col3 {
  background-color: #dbeaf2;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_0ad4d_row1_col1 {
  background-color: #f3f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_0ad4d_row1_col2 {
  background-color: #053061;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_0ad4d_row1_col3 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_0ad4d">
  <thead>
    <tr>
      <th id="T_0ad4d_level0_col0" class="col_heading level0 col0">mean_autocorr</th>
      <th id="T_0ad4d_level0_col1" class="col_heading level0 col1">std_autocorr</th>
      <th id="T_0ad4d_level0_col2" class="col_heading level0 col2">negative_ratio</th>
      <th id="T_0ad4d_level0_col3" class="col_heading level0 col3">positive_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_0ad4d_row0_col0" class="data row0 col0">-0.02876</td>
      <td id="T_0ad4d_row0_col1" class="data row0 col1">+0.02716</td>
      <td id="T_0ad4d_row0_col2" class="data row0 col2">+0.85714</td>
      <td id="T_0ad4d_row0_col3" class="data row0 col3">+0.14286</td>
    </tr>
    <tr>
      <td id="T_0ad4d_row1_col0" class="data row1 col0">-0.02497</td>
      <td id="T_0ad4d_row1_col1" class="data row1 col1">+0.02104</td>
      <td id="T_0ad4d_row1_col2" class="data row1 col2">+1.00000</td>
      <td id="T_0ad4d_row1_col3" class="data row1 col3">+0.00000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The spreads display strongly negative average autocorrelation with a very high share of negative observations, pointing to pronounced mean-reverting behavior and more stable statistical properties than single assets.</p>
</section>
<section id="spread-volatility-1" class="level3">
<h3 class="anchored" data-anchor-id="spread-volatility-1">Spread volatility</h3>
<div class="cell" data-execution_count="17">
<div class="cell-output cell-output-display" data-execution_count="17">

<style type="text/css">
#T_e838c_row0_col0, #T_e838c_row1_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_e838c">
  <thead>
    <tr>
      <th id="T_e838c_level0_col0" class="col_heading level0 col0">avg_volatility</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_e838c_row0_col0" class="data row0 col0">+0.00082</td>
    </tr>
    <tr>
      <td id="T_e838c_row1_col0" class="data row1 col0">+0.00031</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>Spread volatility is lower than the volatility of the underlying assets, reflecting diversification effects and improved risk control.</p>
</section>
<section id="conclusions-for-spreads" class="level3">
<h3 class="anchored" data-anchor-id="conclusions-for-spreads">Conclusions for spreads</h3>
<p>While the spreads do not deliver stable positive returns on their own, their strong mean-reversion characteristics and reduced volatility make them suitable building blocks for more advanced strategies rather than standalone directional trades.</p>
</section>
<section id="portfolio-1" class="level3">
<h3 class="anchored" data-anchor-id="portfolio-1">Portfolio</h3>
<div class="cell" data-execution_count="18">
<div class="cell-output cell-output-display" data-execution_count="18">

<style type="text/css">
#T_c75d0_row0_col0, #T_c75d0_row0_col2, #T_c75d0_row3_col2 {
  background-color: #f8f4f2;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c75d0_row0_col1, #T_c75d0_row5_col0 {
  background-color: #f8f3f0;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c75d0_row1_col0, #T_c75d0_row2_col2, #T_c75d0_row3_col0, #T_c75d0_row5_col1 {
  background-color: #f7f6f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c75d0_row1_col1, #T_c75d0_row1_col2, #T_c75d0_row4_col1, #T_c75d0_row4_col2 {
  background-color: #f5f6f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c75d0_row2_col0, #T_c75d0_row2_col1, #T_c75d0_row3_col1, #T_c75d0_row5_col2 {
  background-color: #f7f5f4;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c75d0_row4_col0, #T_c75d0_row6_col1, #T_c75d0_row6_col2 {
  background-color: #f3f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_c75d0_row6_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_c75d0">
  <thead>
    <tr>
      <th id="T_c75d0_level0_col0" class="col_heading level0 col0">FX</th>
      <th id="T_c75d0_level0_col1" class="col_heading level0 col1">Metals</th>
      <th id="T_c75d0_level0_col2" class="col_heading level0 col2">All</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_c75d0_row0_col0" class="data row0 col0">-0.01995</td>
      <td id="T_c75d0_row0_col1" class="data row0 col1">-0.02465</td>
      <td id="T_c75d0_row0_col2" class="data row0 col2">-0.02257</td>
    </tr>
    <tr>
      <td id="T_c75d0_row1_col0" class="data row1 col0">-0.00579</td>
      <td id="T_c75d0_row1_col1" class="data row1 col1">+0.00862</td>
      <td id="T_c75d0_row1_col2" class="data row1 col2">+0.00832</td>
    </tr>
    <tr>
      <td id="T_c75d0_row2_col0" class="data row2 col0">-0.01226</td>
      <td id="T_c75d0_row2_col1" class="data row2 col1">-0.00901</td>
      <td id="T_c75d0_row2_col2" class="data row2 col2">-0.00635</td>
    </tr>
    <tr>
      <td id="T_c75d0_row3_col0" class="data row3 col0">-0.00435</td>
      <td id="T_c75d0_row3_col1" class="data row3 col1">-0.01273</td>
      <td id="T_c75d0_row3_col2" class="data row3 col2">-0.01885</td>
    </tr>
    <tr>
      <td id="T_c75d0_row4_col0" class="data row4 col0">+0.01714</td>
      <td id="T_c75d0_row4_col1" class="data row4 col1">+0.01178</td>
      <td id="T_c75d0_row4_col2" class="data row4 col2">+0.01324</td>
    </tr>
    <tr>
      <td id="T_c75d0_row5_col0" class="data row5 col0">-0.02847</td>
      <td id="T_c75d0_row5_col1" class="data row5 col1">-0.00540</td>
      <td id="T_c75d0_row5_col2" class="data row5 col2">-0.00934</td>
    </tr>
    <tr>
      <td id="T_c75d0_row6_col0" class="data row6 col0">+0.00006</td>
      <td id="T_c75d0_row6_col1" class="data row6 col1">+0.02338</td>
      <td id="T_c75d0_row6_col2" class="data row6 col2">+0.01957</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The portfolio results show more balanced and less extreme returns compared to single assets and spreads, indicating improved diversification across asset groups.</p>
</section>
<section id="portfolio-stability-1" class="level3">
<h3 class="anchored" data-anchor-id="portfolio-stability-1">Portfolio stability</h3>
<div class="cell" data-execution_count="19">
<div class="cell-output cell-output-display" data-execution_count="19">

<style type="text/css">
#T_1daab_row0_col0, #T_1daab_row1_col0, #T_1daab_row2_col0 {
  background-color: #f7f6f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_1daab_row0_col1 {
  background-color: #f5f6f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_1daab_row0_col2 {
  background-color: #2f79b5;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_1daab_row0_col3 {
  background-color: #b6d7e8;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_1daab_row1_col1, #T_1daab_row2_col1 {
  background-color: #f3f5f6;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
#T_1daab_row1_col2, #T_1daab_row2_col2 {
  background-color: #4c99c6;
  color: #f1f1f1;
  text-align: right;
  font-size: 10px;
}
#T_1daab_row1_col3, #T_1daab_row2_col3 {
  background-color: #87beda;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_1daab">
  <thead>
    <tr>
      <th id="T_1daab_level0_col0" class="col_heading level0 col0">mean_autocorr</th>
      <th id="T_1daab_level0_col1" class="col_heading level0 col1">std_autocorr</th>
      <th id="T_1daab_level0_col2" class="col_heading level0 col2">negative_ratio</th>
      <th id="T_1daab_level0_col3" class="col_heading level0 col3">positive_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_1daab_row0_col0" class="data row0 col0">-0.00766</td>
      <td id="T_1daab_row0_col1" class="data row0 col1">+0.01469</td>
      <td id="T_1daab_row0_col2" class="data row0 col2">+0.71429</td>
      <td id="T_1daab_row0_col3" class="data row0 col3">+0.28571</td>
    </tr>
    <tr>
      <td id="T_1daab_row1_col0" class="data row1 col0">-0.00114</td>
      <td id="T_1daab_row1_col1" class="data row1 col1">+0.01649</td>
      <td id="T_1daab_row1_col2" class="data row1 col2">+0.57143</td>
      <td id="T_1daab_row1_col3" class="data row1 col3">+0.42857</td>
    </tr>
    <tr>
      <td id="T_1daab_row2_col0" class="data row2 col0">-0.00228</td>
      <td id="T_1daab_row2_col1" class="data row2 col1">+0.01624</td>
      <td id="T_1daab_row2_col2" class="data row2 col2">+0.57143</td>
      <td id="T_1daab_row2_col3" class="data row2 col3">+0.42857</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>Autocorrelations are close to zero on average, with a higher share of negative observations, suggesting stable behavior without strong directional dependence and reduced sensitivity to regime changes.</p>
</section>
<section id="portfolio-volatility-1" class="level3">
<h3 class="anchored" data-anchor-id="portfolio-volatility-1">Portfolio volatility</h3>
<div class="cell" data-execution_count="20">
<div class="cell-output cell-output-display" data-execution_count="20">

<style type="text/css">
#T_0a6e3_row0_col0, #T_0a6e3_row1_col0, #T_0a6e3_row2_col0 {
  background-color: #f6f7f7;
  color: #000000;
  text-align: right;
  font-size: 10px;
}
</style>
<table id="T_0a6e3">
  <thead>
    <tr>
      <th id="T_0a6e3_level0_col0" class="col_heading level0 col0">avg_volatility</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_0a6e3_row0_col0" class="data row0 col0">+0.00030</td>
    </tr>
    <tr>
      <td id="T_0a6e3_row1_col0" class="data row1 col0">+0.00076</td>
    </tr>
    <tr>
      <td id="T_0a6e3_row2_col0" class="data row2 col0">+0.00047</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>Portfolio volatility is the lowest among the analyzed structures, highlighting the benefits of diversification and improved risk-adjusted characteristics.</p>
</section>
<section id="conclusions-for-portfolio" class="level3">
<h3 class="anchored" data-anchor-id="conclusions-for-portfolio">Conclusions for portfolio</h3>
<p>The portfolio approach provides the most robust and stable framework, combining diversified returns, low volatility, and consistent statistical properties, making it the preferred choice for further strategy development.</p>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<p>Across the analyzed assets (FX and metals), single-asset strategies do not exhibit stable or repeatable profitability, while spread-based approaches show improved statistical properties but lack consistent positive returns. The portfolio structure delivers the most robust results, combining lower volatility, more stable behavior, and improved diversification. Therefore, a portfolio-based approach is the preferred choice for trading these assets and provides the strongest foundation for further strategy development</p>
<p><strong>However, after adding transaction costs, the best strategies were for single assets in both cases.</strong></p>
</section>
</section>
<section id="in-sample-analysis-of-group-1" class="level2">
<h2 class="anchored" data-anchor-id="in-sample-analysis-of-group-1">In-Sample Analysis of <strong>group 1</strong></h2>
<section id="spread-2" class="level3">
<h3 class="anchored" data-anchor-id="spread-2">Spread</h3>
<p>Based on the correlation and contegration analysis above, first we tried to create a strategy on the spread between NQ and SP. We considered both spread based on prices and based on returns. We analyzed both mean-reverting and trend-following strategies based on moving averages and volatility breakout models.</p>
<section id="spread-based-on-prices" class="level4">
<h4 class="anchored" data-anchor-id="spread-based-on-prices">Spread based on prices</h4>
<p>We can see the spread based on prices below:</p>
<div class="cell" data-execution_count="22">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="spread-based-on-returns" class="level3">
<h3 class="anchored" data-anchor-id="spread-based-on-returns">Spread based on returns</h3>
<p>We can see the spread based on returns below:</p>
<div class="cell" data-execution_count="23">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>all_data_2.index <span class="op">=</span> pd.to_datetime(all_data_2.index)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pos_flat <span class="op">=</span> np.zeros(<span class="bu">len</span>(all_data_2))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we do not trade within the first 25 minutes (9:31-9:55)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># but also before that time since midnight</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>pos_flat[all_data_2.index.time <span class="op">&lt;=</span> pd.to_datetime(<span class="st">"9:55"</span>).time()] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># and last 20 minutes of the session (15:40-16:00)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># but also after this time until midnight</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>pos_flat[all_data_2.index.time <span class="op">&gt;=</span> pd.to_datetime(<span class="st">"15:40"</span>).time()] <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="two-moving-averages-strategy" class="level3">
<h3 class="anchored" data-anchor-id="two-moving-averages-strategy">Two moving averages strategy</h3>
<p>We have tried both trend-following and mean-reverting strategies based on two moving averages. We run the analysis for various combinations of the parameters. The final statistic was calculated for each combination. The profitability of the strategies for spread based on prices can be sumarized on the heatmaps of Net sharpe Ratio below.</p>
<div class="cell" data-execution_count="27">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-28-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-28-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-28-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-28-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-28-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-28-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-28-output-7.png" class="img-fluid"></p>
</div>
</div>
<p>And here are the results for the spread based on returns:</p>
<div class="cell" data-execution_count="29">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-30-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-30-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-30-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-30-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-30-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-30-output-7.png" class="img-fluid"></p>
</div>
</div>
<p>We can see that the results are not very promising, both momentum and mean reversion strategies for spread based on prices and returns. Therefore, we have decided to try different approach based on volatility breakout model.</p>
</section>
<section id="volatility-breakout-model" class="level3">
<h3 class="anchored" data-anchor-id="volatility-breakout-model">Volatility breakout model</h3>
<p>We have tried mean-reverting strategies based on volatility breakout model. We run the analysis for various combinations of the parameters. The profitability of the strategies for spread based on prices and returns can be sumarized by the heatmap of Net SR below. The results are a little bit better, but Net SR is still negative.</p>
<div class="cell" data-execution_count="31">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-32-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-32-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-32-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-32-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-32-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-32-output-7.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="additional-filtering" class="level3">
<h3 class="anchored" data-anchor-id="additional-filtering">Additional filtering</h3>
<p>To further improve the performance of the startegy, we tried various filtering techniques based on correlation, cointegration and regression coefficients between the two instruments. However, none of these techniques brought significant improvement in the results.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate daily correlations for each quarter separately</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>all_correlation_results <span class="op">=</span> []</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> quarter <span class="kw">in</span> quarters:</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for the current quarter</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    quarter_data <span class="op">=</span> all_data_2[all_data_2[<span class="st">'quarter'</span>] <span class="op">==</span> quarter]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate daily correlations for this quarter</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    correlation_p_daily <span class="op">=</span> quarter_data.resample(<span class="st">"D"</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">'NQ'</span>].corr(x[<span class="st">'SP'</span>]))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    correlation_r_daily <span class="op">=</span> quarter_data.resample(<span class="st">"D"</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">'r_NQ'</span>].corr(x[<span class="st">'r_SP'</span>]))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop NaN values</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    correlation_p_daily <span class="op">=</span> correlation_p_daily.dropna()</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    correlation_r_daily <span class="op">=</span> correlation_r_daily.dropna()</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a DataFrame with quarter indicator</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    quarter_correlations <span class="op">=</span> pd.DataFrame({</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'correlation_prices'</span>: correlation_p_daily,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'correlation_returns'</span>: correlation_r_daily,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'quarter'</span>: quarter</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    all_correlation_results.append(quarter_correlations)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Daily Price Correlation - Mean: </span><span class="sc">{</span>correlation_p_daily<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">, Std: </span><span class="sc">{</span>correlation_p_daily<span class="sc">.</span>std()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Daily Returns Correlation - Mean: </span><span class="sc">{</span>correlation_r_daily<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">, Std: </span><span class="sc">{</span>correlation_r_daily<span class="sc">.</span>std()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create figure with 2 subplots side by side</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot price correlation</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(correlation_p_daily.index, correlation_p_daily.values)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="ss">f"Daily correlation between NQ and SP prices - </span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xlabel(<span class="st">"Date"</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_ylabel(<span class="st">"Correlation"</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot returns correlation</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(correlation_r_daily.index, correlation_r_daily.values, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="ss">f"Daily correlation between NQ and SP returns - </span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xlabel(<span class="st">"Date"</span>)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_ylabel(<span class="st">"Correlation"</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all quarters into one DataFrame</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>daily_correlations <span class="op">=</span> pd.concat(all_correlation_results, axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
2023_Q1:
Daily Price Correlation - Mean: 0.7826, Std: 0.3129
Daily Returns Correlation - Mean: 0.6516, Std: 0.4025</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-33-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
2023_Q3:
Daily Price Correlation - Mean: 0.8331, Std: 0.2147
Daily Returns Correlation - Mean: 0.7428, Std: 0.3191</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-33-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
2023_Q4:
Daily Price Correlation - Mean: 0.9339, Std: 0.1187
Daily Returns Correlation - Mean: 0.9098, Std: 0.0421</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-33-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
2024_Q2:
Daily Price Correlation - Mean: 0.9155, Std: 0.1235
Daily Returns Correlation - Mean: 0.9160, Std: 0.0451</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-33-output-8.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
2024_Q4:
Daily Price Correlation - Mean: 0.8736, Std: 0.2002
Daily Returns Correlation - Mean: 0.8670, Std: 0.0951</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-33-output-10.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
2025_Q1:
Daily Price Correlation - Mean: 0.9405, Std: 0.0975
Daily Returns Correlation - Mean: 0.9359, Std: 0.0422</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-33-output-12.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
2025_Q2:
Daily Price Correlation - Mean: 0.9530, Std: 0.0661
Daily Returns Correlation - Mean: 0.9517, Std: 0.0293</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-33-output-14.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> regression_selected(df, y_col, x_col, add_const<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the group is empty return NaNs</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df.empty:</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.Series({</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">'beta'</span>: np.nan,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">'pvalue'</span>: np.nan,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">'tstat'</span>: np.nan,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">'r2'</span>: np.nan</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df[y_col]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> df[[x_col]]  <span class="co"># keep as DataFrame</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> add_const:</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        x_param_name <span class="op">=</span> x_col      <span class="co"># slope name in params/pvalues/etc.</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        x_param_name <span class="op">=</span> x_col      <span class="co"># only column present</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.Series({</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'beta'</span>:   model.params[x_param_name],</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'pvalue'</span>: model.pvalues[x_param_name],</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'tstat'</span>:  model.tvalues[x_param_name],</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'r2'</span>:     model.rsquared</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate regression for each quarter separately</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>regression_results_by_quarter <span class="op">=</span> []</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>daily_regressions_P_all <span class="op">=</span> []</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>daily_regressions_R_all <span class="op">=</span> []</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> quarter <span class="kw">in</span> quarters:</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Processing quarter: </span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for the current quarter</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    quarter_data <span class="op">=</span> all_data_2[all_data_2[<span class="st">'quarter'</span>] <span class="op">==</span> quarter].copy()</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop NaN values for regression</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    quarter_data_clean <span class="op">=</span> quarter_data.dropna(subset<span class="op">=</span>[<span class="st">'NQ'</span>, <span class="st">'SP'</span>])</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    daily_regressions_P <span class="op">=</span> quarter_data_clean.resample(<span class="st">"D"</span>).<span class="bu">apply</span>(</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: regression_selected(x, y_col<span class="op">=</span><span class="st">'SP'</span>, x_col<span class="op">=</span><span class="st">'NQ'</span>, add_const<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    ).dropna()</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    daily_regressions_R <span class="op">=</span> quarter_data_clean.resample(<span class="st">"D"</span>).<span class="bu">apply</span>(</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: regression_selected(x, y_col<span class="op">=</span><span class="st">'r_SP'</span>, x_col<span class="op">=</span><span class="st">'r_NQ'</span>, add_const<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    ).dropna()</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    daily_regressions_P[<span class="st">'quarter'</span>] <span class="op">=</span> quarter</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    daily_regressions_R[<span class="st">'quarter'</span>] <span class="op">=</span> quarter</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    daily_regressions_P_all.append(daily_regressions_P)</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    daily_regressions_R_all.append(daily_regressions_R)</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary dataframe</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>daily_regressions_P_all <span class="op">=</span> pd.DataFrame(pd.concat(daily_regressions_P_all))</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>daily_regressions_R_all <span class="op">=</span> pd.DataFrame(pd.concat(daily_regressions_R_all))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2023_Q1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2023_Q3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2023_Q4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2024_Q2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2024_Q4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2025_Q1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2025_Q2</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lets use PP and KPSS tests for cointegration</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># based on the functions from lab03</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extended to control for empty dataframes</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arch.unitroot <span class="im">import</span> PhillipsPerron, KPSS</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the function to get residuals from OLS regression</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _eg_residuals(df: pd.DataFrame, col1: <span class="bu">str</span>, col2: <span class="bu">str</span>):</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(df[col1].values, has_constant<span class="op">=</span><span class="st">"add"</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df[col2].values</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model.resid</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># the function for PP p-value</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> eg_pp_pvalue(df: pd.DataFrame, col1: <span class="bu">str</span>, col2: <span class="bu">str</span>, </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                 trend: <span class="bu">str</span> <span class="op">=</span> <span class="st">"c"</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the group is empty return NaN</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df.empty:</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    resid <span class="op">=</span> _eg_residuals(df, col1, col2)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(PhillipsPerron(resid, trend<span class="op">=</span>trend).pvalue)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co"># the function for KPSS p-value</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> eg_kpss_pvalue(df: pd.DataFrame, col1: <span class="bu">str</span>, col2: <span class="bu">str</span>, </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>                   trend: <span class="bu">str</span> <span class="op">=</span> <span class="st">"c"</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the group is empty return NaN</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df.empty:</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    resid <span class="op">=</span> _eg_residuals(df, col1, col2)</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(KPSS(resid, trend<span class="op">=</span>trend).pvalue)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="co"># how about daily cointegration tests?</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by date and calculate cointegration tests for each day</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate daily cointegration tests for each quarter separately</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>daily_PP_all <span class="op">=</span> []</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>daily_KPSS_all <span class="op">=</span> []</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> quarter <span class="kw">in</span> quarters:</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Processing quarter: </span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for the current quarter</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    quarter_data <span class="op">=</span> all_data_2[all_data_2[<span class="st">'quarter'</span>] <span class="op">==</span> quarter].dropna(subset<span class="op">=</span>[<span class="st">'NQ'</span>, <span class="st">'SP'</span>])</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Group by date and calculate cointegration tests for each day</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> date, group <span class="kw">in</span> quarter_data.groupby(quarter_data.index.date):</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(group) <span class="op">&gt;</span> <span class="dv">10</span>:  <span class="co"># Ensure enough data points for the test</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>                pp_pvalue <span class="op">=</span> eg_pp_pvalue(group, <span class="st">"NQ"</span>, <span class="st">"SP"</span>)</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>                daily_PP_all.append({<span class="st">'date'</span>: date, <span class="st">'pvalue'</span>: pp_pvalue, <span class="st">'quarter'</span>: quarter})</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>                kpss_pvalue <span class="op">=</span> eg_kpss_pvalue(group, <span class="st">"NQ"</span>, <span class="st">"SP"</span>)</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>                daily_KPSS_all.append({<span class="st">'date'</span>: date, <span class="st">'pvalue'</span>: kpss_pvalue, <span class="st">'quarter'</span>: quarter})</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to DataFrames with date index</span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>daily_PP_tests <span class="op">=</span> pd.DataFrame(daily_PP_all).set_index(<span class="st">'date'</span>)</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>daily_KPSS_tests <span class="op">=</span> pd.DataFrame(daily_KPSS_all).set_index(<span class="st">'date'</span>)</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove NaN values</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>daily_PP_tests <span class="op">=</span> daily_PP_tests.dropna(subset<span class="op">=</span>[<span class="st">'pvalue'</span>])</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>daily_KPSS_tests <span class="op">=</span> daily_KPSS_tests.dropna(subset<span class="op">=</span>[<span class="st">'pvalue'</span>])</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>all_data_2_nonan <span class="op">=</span> all_data_2.dropna(subset<span class="op">=</span>[<span class="st">'NQ'</span>, <span class="st">'SP'</span>])</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the index is datetime and localized</span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>daily_PP_tests.index <span class="op">=</span> pd.to_datetime(daily_PP_tests.index).tz_localize(all_data_2_nonan.index.tz)</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>daily_KPSS_tests.index <span class="op">=</span> pd.to_datetime(daily_KPSS_tests.index).tz_localize(all_data_2_nonan.index.tz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2023_Q1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2023_Q3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2023_Q4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2024_Q2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2024_Q4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2025_Q1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2025_Q2</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2023_Q1
  volat_sd: 90, m: 3.5</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Net SR: -8.4799, Net PnL: -3117.36
Processing quarter: 2023_Q3
  volat_sd: 90, m: 3.5
  Net SR: -7.7066, Net PnL: -2591.22
Processing quarter: 2023_Q4
  volat_sd: 90, m: 3.5</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Net SR: -7.1385, Net PnL: -1418.89
Processing quarter: 2024_Q2
  volat_sd: 90, m: 3.5
  Net SR: -7.7902, Net PnL: -1927.60
Processing quarter: 2024_Q4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  volat_sd: 90, m: 3.5
  Net SR: -5.6910, Net PnL: -1879.89
Processing quarter: 2025_Q1
  volat_sd: 90, m: 3.5</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Net SR: -3.8325, Net PnL: -969.17
Processing quarter: 2025_Q2
  volat_sd: 90, m: 3.5
  Net SR: -5.3477, Net PnL: -3269.11</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Gross PnL SR: -0.18185374132780383
Net PnL SR: -7.280207416286564
Average number of trades per day: 1.1497797356828194
Gross PnL SR after applying filter_correlation_prices_06: -0.10696738478480869
Net PnL SR after applying filter_correlation_prices_06: -6.391251450355618
Average number of trades per day after applying filter_correlation_prices_06: 0.952914798206278

Processing quarter: 2023_Q1

Processing quarter: 2023_Q3

Processing quarter: 2023_Q4

Processing quarter: 2024_Q2

Processing quarter: 2024_Q4

Processing quarter: 2025_Q1

Processing quarter: 2025_Q2</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="36">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>quarter</th>
      <th>filter</th>
      <th>gross_SR</th>
      <th>net_SR</th>
      <th>gross_PnL</th>
      <th>net_PnL</th>
      <th>avg_n_trades_per_day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>2023_Q1</td>
      <td>filter_regression_price_beta_sig_above05</td>
      <td>-2.016065</td>
      <td>-2.016065</td>
      <td>-30.844220</td>
      <td>-125.881528</td>
      <td>0.063492</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2023_Q3</td>
      <td>filter_KPSS_cointegration_10</td>
      <td>-1.908743</td>
      <td>-2.446851</td>
      <td>-107.629150</td>
      <td>-278.768488</td>
      <td>0.093750</td>
    </tr>
    <tr>
      <th>54</th>
      <td>2023_Q4</td>
      <td>filter_KPSS_cointegration_10</td>
      <td>-2.358602</td>
      <td>-3.684726</td>
      <td>-122.428846</td>
      <td>-348.606399</td>
      <td>0.125000</td>
    </tr>
    <tr>
      <th>65</th>
      <td>2024_Q2</td>
      <td>filter_regression_price_beta_sig_above025</td>
      <td>-1.039645</td>
      <td>-3.485719</td>
      <td>-33.079186</td>
      <td>-241.990340</td>
      <td>0.125000</td>
    </tr>
    <tr>
      <th>92</th>
      <td>2024_Q4</td>
      <td>filter_KPSS_cointegration_10</td>
      <td>1.668130</td>
      <td>0.138995</td>
      <td>319.621792</td>
      <td>24.470688</td>
      <td>0.156250</td>
    </tr>
    <tr>
      <th>109</th>
      <td>2025_Q1</td>
      <td>filter_PP_cointegration_05</td>
      <td>0.658769</td>
      <td>-2.803370</td>
      <td>84.454987</td>
      <td>-420.379503</td>
      <td>0.290323</td>
    </tr>
    <tr>
      <th>130</th>
      <td>2025_Q2</td>
      <td>filter_KPSS_cointegration_10</td>
      <td>-2.151107</td>
      <td>-2.831739</td>
      <td>-745.962758</td>
      <td>-1219.248775</td>
      <td>0.276923</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We can see that none of the filters were able to improve the performance of the strategy in a consistent manner across all quarters. Therefore, we have decided to proceed with single asset strategies. We can see that considering spreads increased transaction costs, due to trading both instruments, negatively impact the net PnL and Sharpe ratios. Analyzing the example strategy for spreads, we can see that the gap between gross and net PnL is significant, indicating high transaction costs. Therefore, we have decided to proceed with single asset strategies.</p>
</section>
</section>
<section id="single-asset-strategies" class="level2">
<h2 class="anchored" data-anchor-id="single-asset-strategies">Single asset strategies</h2>
<p>After analyzing various strategies based on spreads, we have decided to focus on single asset strategies for <strong>SP</strong>. We have tested both momentum and mean reversion strategies for each asset, using intersecting two moving avarages and volatility breakout models with different parameters.</p>
<section id="two-moving-averages-strategy-1" class="level3">
<h3 class="anchored" data-anchor-id="two-moving-averages-strategy-1">Two moving averages strategy</h3>
<p>First, we have implemented the two moving averages strategy for <strong>SP</strong>. We have tested various combinations of fast and slow EMA parameters to find the optimal settings for the strategy. We can see on the heatmap of Net Sharpe Ratio, that certain combinations of parameters yield better results than for spread-based strategies. However, the performance is not satisfactory, regarding the sum of evaluation statistic across all quarters, represented on the last heatmap.</p>
<div class="cell" data-execution_count="38">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-39-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-39-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-39-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-39-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-39-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-39-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-39-output-7.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-40-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="volatility-breakout-strategy" class="level3">
<h3 class="anchored" data-anchor-id="volatility-breakout-strategy">Volatility breakout strategy</h3>
<p>Lets now analyze the volatility breakout strategy for <strong>SP</strong>. Similar to the previous strategy, we have tested various combinations of signal and slow EMA parameters, along with different window lengths and multipliers for volatility calculation.</p>
</section>
<section id="stop-loss-condition" class="level3">
<h3 class="anchored" data-anchor-id="stop-loss-condition">Stop-loss condition</h3>
<p>To further enhance the robustness of the selected strategy, we have implemented a stop-loss condition. This condition limits the maximum daily loss to $500, helping to mitigate potential drawdowns during adverse market movements. The stop-loss is applied at the end of each trading day, ensuring that any losses exceeding this threshold are curtailed.</p>
<div class="cell" data-execution_count="41">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-42-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="finally-selected-strategy-for-group-1" class="level2">
<h2 class="anchored" data-anchor-id="finally-selected-strategy-for-group-1">Finally selected strategy for <strong>group 1</strong></h2>
<p>As a result of the trial and error process, we have ended with volatility breakout model with momentum strategy for <strong>SP</strong> with signal and slow EMA of 30 and 240 respectively. The window length used in volatilities calculation was set to 120, while the multiplier for lower and upper threshold was set to 1. The stop-loss assumption was set as maximum of $500 loss per day.</p>
</section>
<section id="summary-of-results-for-group-1" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-results-for-group-1">Summary of results for <strong>group 1</strong></h2>
<div class="cell" data-execution_count="43">
<div class="cell-output cell-output-display" data-execution_count="43">

<style type="text/css">
#T_957fd th {
  font-size: 10px;
}
#T_957fd td {
  font-size: 10px;
}
#T_957fd_row0_col0, #T_957fd_row0_col1, #T_957fd_row0_col2, #T_957fd_row0_col3, #T_957fd_row0_col4, #T_957fd_row0_col5, #T_957fd_row0_col6, #T_957fd_row0_col7, #T_957fd_row0_col8, #T_957fd_row1_col0, #T_957fd_row1_col1, #T_957fd_row1_col2, #T_957fd_row1_col3, #T_957fd_row1_col4, #T_957fd_row1_col5, #T_957fd_row1_col6, #T_957fd_row1_col7, #T_957fd_row1_col8, #T_957fd_row2_col0, #T_957fd_row2_col1, #T_957fd_row2_col2, #T_957fd_row2_col3, #T_957fd_row2_col4, #T_957fd_row2_col5, #T_957fd_row2_col6, #T_957fd_row2_col7, #T_957fd_row2_col8, #T_957fd_row3_col0, #T_957fd_row3_col1, #T_957fd_row3_col2, #T_957fd_row3_col3, #T_957fd_row3_col4, #T_957fd_row3_col5, #T_957fd_row3_col6, #T_957fd_row3_col7, #T_957fd_row3_col8, #T_957fd_row4_col0, #T_957fd_row4_col1, #T_957fd_row4_col2, #T_957fd_row4_col3, #T_957fd_row4_col4, #T_957fd_row4_col5, #T_957fd_row4_col6, #T_957fd_row4_col7, #T_957fd_row4_col8, #T_957fd_row5_col0, #T_957fd_row5_col1, #T_957fd_row5_col2, #T_957fd_row5_col3, #T_957fd_row5_col4, #T_957fd_row5_col5, #T_957fd_row5_col6, #T_957fd_row5_col7, #T_957fd_row5_col8, #T_957fd_row6_col0, #T_957fd_row6_col1, #T_957fd_row6_col2, #T_957fd_row6_col3, #T_957fd_row6_col4, #T_957fd_row6_col5, #T_957fd_row6_col6, #T_957fd_row6_col7, #T_957fd_row6_col8, #T_957fd_row7_col0, #T_957fd_row7_col1, #T_957fd_row7_col2, #T_957fd_row7_col3, #T_957fd_row7_col4, #T_957fd_row7_col5, #T_957fd_row7_col6, #T_957fd_row7_col7, #T_957fd_row7_col8, #T_957fd_row8_col0, #T_957fd_row8_col1, #T_957fd_row8_col2, #T_957fd_row8_col3, #T_957fd_row8_col4, #T_957fd_row8_col5, #T_957fd_row8_col6, #T_957fd_row8_col7, #T_957fd_row8_col8, #T_957fd_row9_col0, #T_957fd_row9_col1, #T_957fd_row9_col2, #T_957fd_row9_col3, #T_957fd_row9_col4, #T_957fd_row9_col5, #T_957fd_row9_col6, #T_957fd_row9_col7, #T_957fd_row9_col8, #T_957fd_row10_col0, #T_957fd_row10_col1, #T_957fd_row10_col2, #T_957fd_row10_col3, #T_957fd_row10_col4, #T_957fd_row10_col5, #T_957fd_row10_col6, #T_957fd_row10_col7, #T_957fd_row10_col8, #T_957fd_row11_col0, #T_957fd_row11_col1, #T_957fd_row11_col2, #T_957fd_row11_col3, #T_957fd_row11_col4, #T_957fd_row11_col5, #T_957fd_row11_col6, #T_957fd_row11_col7, #T_957fd_row11_col8 {
  text-align: right;
}
</style>
<table id="T_957fd">
  <thead>
    <tr>
      <th id="T_957fd_level0_col0" class="col_heading level0 col0">quarter</th>
      <th id="T_957fd_level0_col1" class="col_heading level0 col1">gross_SR</th>
      <th id="T_957fd_level0_col2" class="col_heading level0 col2">net_SR</th>
      <th id="T_957fd_level0_col3" class="col_heading level0 col3">gross_PnL</th>
      <th id="T_957fd_level0_col4" class="col_heading level0 col4">net_PnL</th>
      <th id="T_957fd_level0_col5" class="col_heading level0 col5">gross_CR</th>
      <th id="T_957fd_level0_col6" class="col_heading level0 col6">net_CR</th>
      <th id="T_957fd_level0_col7" class="col_heading level0 col7">av_daily_ntrans</th>
      <th id="T_957fd_level0_col8" class="col_heading level0 col8">stat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_957fd_row0_col0" class="data row0 col0">2023_Q1</td>
      <td id="T_957fd_row0_col1" class="data row0 col1">5.93</td>
      <td id="T_957fd_row0_col2" class="data row0 col2">5.54</td>
      <td id="T_957fd_row0_col3" class="data row0 col3">23710.55</td>
      <td id="T_957fd_row0_col4" class="data row0 col4">22150.55</td>
      <td id="T_957fd_row0_col5" class="data row0 col5">62.32</td>
      <td id="T_957fd_row0_col6" class="data row0 col6">54.69</td>
      <td id="T_957fd_row0_col7" class="data row0 col7">2.00</td>
      <td id="T_957fd_row0_col8" class="data row0 col8">15.60</td>
    </tr>
    <tr>
      <td id="T_957fd_row1_col0" class="data row1 col0">2023_Q2</td>
      <td id="T_957fd_row1_col1" class="data row1 col1">5.26</td>
      <td id="T_957fd_row1_col2" class="data row1 col2">4.59</td>
      <td id="T_957fd_row1_col3" class="data row1 col3">12668.95</td>
      <td id="T_957fd_row1_col4" class="data row1 col4">11084.95</td>
      <td id="T_957fd_row1_col5" class="data row1 col5">35.54</td>
      <td id="T_957fd_row1_col6" class="data row1 col6">31.63</td>
      <td id="T_957fd_row1_col7" class="data row1 col7">2.06</td>
      <td id="T_957fd_row1_col8" class="data row1 col8">9.85</td>
    </tr>
    <tr>
      <td id="T_957fd_row2_col0" class="data row2 col0">2023_Q3</td>
      <td id="T_957fd_row2_col1" class="data row2 col1">1.63</td>
      <td id="T_957fd_row2_col2" class="data row2 col2">0.85</td>
      <td id="T_957fd_row2_col3" class="data row2 col3">3277.05</td>
      <td id="T_957fd_row2_col4" class="data row2 col4">1717.05</td>
      <td id="T_957fd_row2_col5" class="data row2 col5">5.09</td>
      <td id="T_957fd_row2_col6" class="data row2 col6">3.72</td>
      <td id="T_957fd_row2_col7" class="data row2 col7">2.00</td>
      <td id="T_957fd_row2_col8" class="data row2 col8">0.19</td>
    </tr>
    <tr>
      <td id="T_957fd_row3_col0" class="data row3 col0">2023_Q4</td>
      <td id="T_957fd_row3_col1" class="data row3 col1">3.19</td>
      <td id="T_957fd_row3_col2" class="data row3 col2">2.62</td>
      <td id="T_957fd_row3_col3" class="data row3 col3">9257.25</td>
      <td id="T_957fd_row3_col4" class="data row3 col4">7625.25</td>
      <td id="T_957fd_row3_col5" class="data row3 col5">15.51</td>
      <td id="T_957fd_row3_col6" class="data row3 col6">13.30</td>
      <td id="T_957fd_row3_col7" class="data row3 col7">2.12</td>
      <td id="T_957fd_row3_col8" class="data row3 col8">4.31</td>
    </tr>
    <tr>
      <td id="T_957fd_row4_col0" class="data row4 col0">2024_Q1</td>
      <td id="T_957fd_row4_col1" class="data row4 col1">3.12</td>
      <td id="T_957fd_row4_col2" class="data row4 col2">2.53</td>
      <td id="T_957fd_row4_col3" class="data row4 col3">8824.45</td>
      <td id="T_957fd_row4_col4" class="data row4 col4">7168.45</td>
      <td id="T_957fd_row4_col5" class="data row4 col5">11.37</td>
      <td id="T_957fd_row4_col6" class="data row4 col6">9.59</td>
      <td id="T_957fd_row4_col7" class="data row4 col7">2.16</td>
      <td id="T_957fd_row4_col8" class="data row4 col8">4.00</td>
    </tr>
    <tr>
      <td id="T_957fd_row5_col0" class="data row5 col0">2024_Q2</td>
      <td id="T_957fd_row5_col1" class="data row5 col1">1.28</td>
      <td id="T_957fd_row5_col2" class="data row5 col2">0.75</td>
      <td id="T_957fd_row5_col3" class="data row5 col3">3809.35</td>
      <td id="T_957fd_row5_col4" class="data row5 col4">2225.35</td>
      <td id="T_957fd_row5_col5" class="data row5 col5">3.97</td>
      <td id="T_957fd_row5_col6" class="data row5 col6">2.96</td>
      <td id="T_957fd_row5_col7" class="data row5 col7">2.03</td>
      <td id="T_957fd_row5_col8" class="data row5 col8">0.20</td>
    </tr>
    <tr>
      <td id="T_957fd_row6_col0" class="data row6 col0">2024_Q3</td>
      <td id="T_957fd_row6_col1" class="data row6 col1">2.19</td>
      <td id="T_957fd_row6_col2" class="data row6 col2">1.68</td>
      <td id="T_957fd_row6_col3" class="data row6 col3">6885.35</td>
      <td id="T_957fd_row6_col4" class="data row6 col4">5301.35</td>
      <td id="T_957fd_row6_col5" class="data row6 col5">8.75</td>
      <td id="T_957fd_row6_col6" class="data row6 col6">7.46</td>
      <td id="T_957fd_row6_col7" class="data row6 col7">2.00</td>
      <td id="T_957fd_row6_col8" class="data row6 col8">1.97</td>
    </tr>
    <tr>
      <td id="T_957fd_row7_col0" class="data row7 col0">2024_Q4</td>
      <td id="T_957fd_row7_col1" class="data row7 col1">3.46</td>
      <td id="T_957fd_row7_col2" class="data row7 col2">2.79</td>
      <td id="T_957fd_row7_col3" class="data row7 col3">8340.90</td>
      <td id="T_957fd_row7_col4" class="data row7 col4">6732.90</td>
      <td id="T_957fd_row7_col5" class="data row7 col5">19.43</td>
      <td id="T_957fd_row7_col6" class="data row7 col6">16.02</td>
      <td id="T_957fd_row7_col7" class="data row7 col7">2.06</td>
      <td id="T_957fd_row7_col8" class="data row7 col8">4.36</td>
    </tr>
    <tr>
      <td id="T_957fd_row8_col0" class="data row8 col0">2025_Q1</td>
      <td id="T_957fd_row8_col1" class="data row8 col1">-0.12</td>
      <td id="T_957fd_row8_col2" class="data row8 col2">-0.67</td>
      <td id="T_957fd_row8_col3" class="data row8 col3">-324.65</td>
      <td id="T_957fd_row8_col4" class="data row8 col4">-1836.65</td>
      <td id="T_957fd_row8_col5" class="data row8 col5">-0.28</td>
      <td id="T_957fd_row8_col6" class="data row8 col6">-0.97</td>
      <td id="T_957fd_row8_col7" class="data row8 col7">2.00</td>
      <td id="T_957fd_row8_col8" class="data row8 col8">-0.71</td>
    </tr>
    <tr>
      <td id="T_957fd_row9_col0" class="data row9 col0">2025_Q2</td>
      <td id="T_957fd_row9_col1" class="data row9 col1">3.15</td>
      <td id="T_957fd_row9_col2" class="data row9 col2">2.89</td>
      <td id="T_957fd_row9_col3" class="data row9 col3">18483.05</td>
      <td id="T_957fd_row9_col4" class="data row9 col4">16923.05</td>
      <td id="T_957fd_row9_col5" class="data row9 col5">41.70</td>
      <td id="T_957fd_row9_col6" class="data row9 col6">37.71</td>
      <td id="T_957fd_row9_col7" class="data row9 col7">2.00</td>
      <td id="T_957fd_row9_col8" class="data row9 col8">6.75</td>
    </tr>
    <tr>
      <td id="T_957fd_row10_col0" class="data row10 col0">2025_Q3</td>
      <td id="T_957fd_row10_col1" class="data row10 col1">1.68</td>
      <td id="T_957fd_row10_col2" class="data row10 col2">0.97</td>
      <td id="T_957fd_row10_col3" class="data row10 col3">3806.75</td>
      <td id="T_957fd_row10_col4" class="data row10 col4">2198.75</td>
      <td id="T_957fd_row10_col5" class="data row10 col5">4.24</td>
      <td id="T_957fd_row10_col6" class="data row10 col6">3.01</td>
      <td id="T_957fd_row10_col7" class="data row10 col7">2.03</td>
      <td id="T_957fd_row10_col8" class="data row10 col8">0.37</td>
    </tr>
    <tr>
      <td id="T_957fd_row11_col0" class="data row11 col0">2025_Q4</td>
      <td id="T_957fd_row11_col1" class="data row11 col1">2.58</td>
      <td id="T_957fd_row11_col2" class="data row11 col2">1.86</td>
      <td id="T_957fd_row11_col3" class="data row11 col3">1981.85</td>
      <td id="T_957fd_row11_col4" class="data row11 col4">1429.85</td>
      <td id="T_957fd_row11_col5" class="data row11 col5">10.36</td>
      <td id="T_957fd_row11_col6" class="data row11 col6">8.18</td>
      <td id="T_957fd_row11_col7" class="data row11 col7">2.00</td>
      <td id="T_957fd_row11_col8" class="data row11 col8">0.49</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The table summarizes the quarterly performance of the selected strategy for Group 1. Across most quarters, the strategy generates positive gross and net Sharpe ratios, indicating consistent risk-adjusted performance. Gross and net PnL remain positive in the majority of periods, with net results reflecting reasonable transaction costs and execution effects.</p>
<p>While performance varies across quarters, drawdowns and net capital requirements remain controlled, suggesting stable risk exposure. Average daily transaction statistics are relatively stable over time, indicating consistent trading activity without excessive turnover.</p>
<p>Overall, the results demonstrate that the strategy delivers robust and repeatable performance across different market regimes, supporting its suitability as the final choice for Group 1.</p>
</section>
<section id="equity-line-for-group-1-2023q1" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2023q1">Equity line for <strong>group 1</strong> – 2023Q1</h2>
<div class="cell" data-execution_count="44">
<div class="cell-output cell-output-display" data-execution_count="44">
<p><img src="final_report%20(1)_files/figure-html/cell-45-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>We can see that both gross and net cumulative PnL are rising. Small gap between the, indicating low costs.</p>
</section>
<section id="equity-line-for-group-1-2023q2" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2023q2">Equity line for <strong>group 1</strong> – 2023Q2</h2>
<div class="cell" data-execution_count="45">
<div class="cell-output cell-output-display" data-execution_count="45">
<p><img src="final_report%20(1)_files/figure-html/cell-46-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>We can see that both gross and net cumulative PnL are rising. Small gap between the, indicating low costs.</p>
</section>
<section id="equity-line-for-group-1-2023q3" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2023q3">Equity line for <strong>group 1</strong> – 2023Q3</h2>
<div class="cell" data-execution_count="46">
<div class="cell-output cell-output-display" data-execution_count="46">
<p><img src="final_report%20(1)_files/figure-html/cell-47-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>More volatility can be observed - also bigger difference bewteen gross and net PnL. However, still positive PnL.</p>
</section>
<section id="equity-line-for-group-1-2023q4" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2023q4">Equity line for <strong>group 1</strong> – 2023Q4</h2>
<div class="cell" data-execution_count="47">
<div class="cell-output cell-output-display" data-execution_count="47">
<p><img src="final_report%20(1)_files/figure-html/cell-48-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Rising trend of both gross and net PnL. Strategy behavior is consistent. A little divergence can be observed over time.</p>
</section>
<section id="equity-line-for-group-1-2024q1" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2024q1">Equity line for <strong>group 1</strong> – 2024Q1</h2>
<div class="cell" data-execution_count="48">
<div class="cell-output cell-output-display" data-execution_count="48">
<p><img src="final_report%20(1)_files/figure-html/cell-49-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The equity line shows a steadily rising trajectory with moderate drawdowns, while the gap between gross and net PnL remains stable, indicating consistent performance after transaction costs.</p>
</section>
<section id="equity-line-for-group-1-2024q2" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2024q2">Equity line for <strong>group 1</strong> – 2024Q2</h2>
<div class="cell" data-execution_count="49">
<div class="cell-output cell-output-display" data-execution_count="49">
<p><img src="final_report%20(1)_files/figure-html/cell-50-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The start of the quarter was really good - gross and net PnL close together and rising quickly. However, the second half of the quarter it turned into losing startegy.</p>
</section>
<section id="equity-line-for-group-1-2024q3" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2024q3">Equity line for <strong>group 1</strong> – 2024Q3</h2>
<div class="cell" data-execution_count="50">
<div class="cell-output cell-output-display" data-execution_count="50">
<p><img src="final_report%20(1)_files/figure-html/cell-51-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Rising trend of both gross and net PnL. Strategy behavior is consistent. A little divergence can be observed over time.</p>
</section>
<section id="equity-line-for-group-1-2024q4" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2024q4">Equity line for <strong>group 1</strong> – 2024Q4</h2>
<div class="cell" data-execution_count="51">
<div class="cell-output cell-output-display" data-execution_count="51">
<p><img src="final_report%20(1)_files/figure-html/cell-52-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Strong, upward trend for both gross and net PnL. Final cumulative net PnL is lower than it could be - strong decrease in last couple of days.</p>
</section>
<section id="equity-line-for-group-1-2025q1" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2025q1">Equity line for <strong>group 1</strong> – 2025Q1</h2>
<div class="cell" data-execution_count="52">
<div class="cell-output cell-output-display" data-execution_count="52">
<p><img src="final_report%20(1)_files/figure-html/cell-53-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Strongly volatile both gross and net PnL - mostly in the negative values. Not the best strategy for this quarter.</p>
</section>
<section id="equity-line-for-group-1-2025q2" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2025q2">Equity line for <strong>group 1</strong> – 2025Q2</h2>
<div class="cell" data-execution_count="53">
<div class="cell-output cell-output-display" data-execution_count="53">
<p><img src="final_report%20(1)_files/figure-html/cell-54-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Sharp increase in first 15 days with low costs. Then stable for the rest of the quarter - strong final cumulative net PnL of more than $18,000.</p>
</section>
<section id="equity-line-for-group-1-2025q3" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2025q3">Equity line for <strong>group 1</strong> – 2025Q3</h2>
<div class="cell" data-execution_count="54">
<div class="cell-output cell-output-display" data-execution_count="54">
<p><img src="final_report%20(1)_files/figure-html/cell-55-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The equity line in 2025Q3 is highly volatile, with a deep mid-quarter drawdown followed by a sharp recovery, indicating unstable performance but strong late-period rebound.</p>
</section>
<section id="equity-line-for-group-1-2025q4" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-1-2025q4">Equity line for <strong>group 1</strong> – 2025Q4</h2>
<div class="cell" data-execution_count="55">
<div class="cell-output cell-output-display" data-execution_count="55">
<p><img src="final_report%20(1)_files/figure-html/cell-56-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Here we can see an early drawdown followed by a steady recovery and a strong finish, suggesting improving performance and better end-of-period stability.</p>
</section>
<section id="in-sample-analysis-of-group-2" class="level2">
<h2 class="anchored" data-anchor-id="in-sample-analysis-of-group-2">In-Sample Analysis of <strong>group 2</strong></h2>
<section id="spread-3" class="level3">
<h3 class="anchored" data-anchor-id="spread-3">Spread</h3>
<p>Based on the correlation and cointegration analysis conducted above, first we tried to create a strategy on the spread between <strong>XAG</strong> and <strong>XAU</strong>. However, the spread did not show strong mean-reverting properties, and attempts to build a mean-reversion strategy on this spread resulted in suboptimal performance.</p>
</section>
<section id="spread-based-on-prices-1" class="level3">
<h3 class="anchored" data-anchor-id="spread-based-on-prices-1">Spread based on prices</h3>
<div class="cell" data-execution_count="56">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-57-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-57-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-57-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-57-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-57-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-57-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-57-output-7.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-58-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="spread-based-on-returns-1" class="level3">
<h3 class="anchored" data-anchor-id="spread-based-on-returns-1">Spread based on returns</h3>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the ratio for each quarter</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ratio_sds_results <span class="op">=</span> []</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize list to store all av_ratio data with quarter identification</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>all_sds_ratios <span class="op">=</span> []</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> quarter <span class="kw">in</span> quarters:</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    data2 <span class="op">=</span> pd.read_parquet(<span class="ss">f'data/data2_</span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">.parquet'</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    data2[<span class="st">'datetime'</span>] <span class="op">=</span> pd.to_datetime(data2[<span class="st">'datetime'</span>])</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    data2.set_index(<span class="st">'datetime'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    data_r <span class="op">=</span> np.log(data2 <span class="op">/</span> data2.shift(<span class="dv">1</span>)) <span class="op">*</span> <span class="dv">10000</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    data_r.columns <span class="op">=</span> [<span class="st">'r_'</span> <span class="op">+</span> col <span class="cf">for</span> col <span class="kw">in</span> data_r.columns]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    data_2_temp <span class="op">=</span> pd.concat(</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>        [data2[[<span class="st">'XAG'</span>, <span class="st">'XAU'</span>]],</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        data_r[[<span class="st">'r_XAU'</span>, <span class="st">'r_XAG'</span>]]],</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the ratio SP / NQ</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    ratio_temp <span class="op">=</span> data_2_temp.resample(<span class="st">"D"</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">'r_XAU'</span>].std() <span class="op">/</span> x[<span class="st">'r_XAG'</span>].std())</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute daily averages</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    sds_ratio_temp <span class="op">=</span> ratio_temp.dropna()</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    ratio_results.append({</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Quarter'</span>: quarter,</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Mean_Ratio'</span>: sds_ratio_temp.mean(),</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Std_Ratio'</span>: sds_ratio_temp.std(),</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Min_Ratio'</span>: sds_ratio_temp.<span class="bu">min</span>(),</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Max_Ratio'</span>: sds_ratio_temp.<span class="bu">max</span>()</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store av_ratio with quarter identification</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>    sds_ratio_quarter <span class="op">=</span> sds_ratio_temp.to_frame(name<span class="op">=</span><span class="st">'sds_ratio'</span>)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    sds_ratio_quarter[<span class="st">'quarter'</span>] <span class="op">=</span> quarter</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    sds_ratio_quarter.index <span class="op">=</span> sds_ratio_quarter.index <span class="op">+</span> pd.to_timedelta(np.where(sds_ratio_quarter.index.day_name() <span class="op">==</span> <span class="st">"Friday"</span>, <span class="st">"3D"</span>, <span class="st">"1D"</span>)) <span class="op">+</span> pd.Timedelta(<span class="st">"0m"</span>)</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    all_sds_ratios.append(sds_ratio_quarter)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all av_ratios into one DataFrame</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>all_sds_ratios_df <span class="op">=</span> pd.concat(all_sds_ratios, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary dataframe</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>ratio_summary <span class="op">=</span> pd.DataFrame(ratio_results)</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Create charts for each quarter</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="bu">len</span>(quarters), <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span><span class="op">*</span><span class="bu">len</span>(quarters)))</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, quarter <span class="kw">in</span> <span class="bu">enumerate</span>(quarters):</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>    quarter_data <span class="op">=</span> all_sds_ratios_df[all_sds_ratios_df[<span class="st">'quarter'</span>] <span class="op">==</span> quarter]</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>    axes[idx].plot(quarter_data.index, quarter_data[<span class="st">'sds_ratio'</span>].values)</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>    axes[idx].set_title(<span class="ss">f"Average Daily XAU/XAG Ratio - </span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>    axes[idx].set_xlabel(<span class="st">"Date"</span>)</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>    axes[idx].set_ylabel(<span class="st">"Average Ratio"</span>)</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>    axes[idx].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>    axes[idx].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-59-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="trading-hours-restriction" class="level3">
<h3 class="anchored" data-anchor-id="trading-hours-restriction">Trading hours restriction</h3>
<p>Based on the analysis of trading hours impact on volatility and liquidity, we have decided to restrict trading activity to specific time windows. This approach aims to capitalize on periods of higher market activity while avoiding times of low liquidity that could lead to unfavorable trading conditions.</p>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>all_data_2.index <span class="op">=</span> pd.to_datetime(all_data_2.index)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>pos_flat <span class="op">=</span> np.zeros(<span class="bu">len</span>(all_data_2))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>breaks <span class="op">=</span> (all_data_2.index.time <span class="op">&gt;=</span> pd.to_datetime(<span class="st">"16:51"</span>).time()) <span class="op">&amp;</span> <span class="op">\</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>          (all_data_2.index.time <span class="op">&lt;=</span> pd.to_datetime(<span class="st">"18:10"</span>).time())</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>pos_flat[breaks] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>dweek_ <span class="op">=</span> all_data_2.index.dayofweek <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>time_ <span class="op">=</span> all_data_2.index.time</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>pos_flat[((dweek_ <span class="op">==</span> <span class="dv">5</span>) <span class="op">&amp;</span> (time_ <span class="op">&gt;</span> pd.to_datetime(<span class="st">'17:00'</span>).time())) <span class="op">|</span>      <span class="co"># end of Friday</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>        (dweek_ <span class="op">==</span> <span class="dv">6</span>) <span class="op">|</span>                                                      <span class="co"># whole Saturday (just in case)</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        ((dweek_ <span class="op">==</span> <span class="dv">7</span>) <span class="op">&amp;</span> (time_ <span class="op">&lt;=</span> pd.to_datetime(<span class="st">'18:00'</span>).time()))] <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="two-intersecting-moving-avarages" class="level3">
<h3 class="anchored" data-anchor-id="two-intersecting-moving-avarages">Two intersecting moving avarages</h3>
<p>First, similarily to group 1, we have tried to implement two intersecting moving averages strategy on spreads based on prices and returns. However, the results were not satisfactory, leading us to explore alternative strategies.</p>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we check various parameter combinations in a loop</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mySR(x, scale):</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sqrt(scale) <span class="op">*</span> np.nanmean(x) <span class="op">/</span> np.nanstd(x)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>fastEMA_parameters <span class="op">=</span> [<span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">75</span>, <span class="dv">90</span>]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>slowEMA_parameters <span class="op">=</span> [<span class="dv">90</span>, <span class="dv">120</span>, <span class="dv">150</span>, <span class="dv">180</span>, <span class="dv">240</span>, <span class="dv">300</span>, <span class="dv">360</span>, <span class="dv">420</span>]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataframe to store results</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>summary_all_2MAs <span class="op">=</span> pd.DataFrame()</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each quarter</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> quarter <span class="kw">in</span> quarters:</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Processing quarter: </span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for the current quarter</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    quarter_mask <span class="op">=</span> all_data_2[<span class="st">'quarter'</span>] <span class="op">==</span> quarter</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    quarter_data <span class="op">=</span> all_data_2[quarter_mask].copy()</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Loop over different parameter combinations</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> fastEMA <span class="kw">in</span> fastEMA_parameters:</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> slowEMA <span class="kw">in</span> slowEMA_parameters:</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># ensure that fastEMA is less than slowEMA</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> fastEMA <span class="op">&gt;=</span> slowEMA:</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"  fastEMA = </span><span class="sc">{</span>fastEMA<span class="sc">}</span><span class="ss">, slowEMA = </span><span class="sc">{</span>slowEMA<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># We calculate the appropriate EMA</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>                    fastEMA_values <span class="op">=</span> quarter_data[<span class="st">'spread_avratio'</span>].ewm(span <span class="op">=</span> fastEMA).mean()</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>                    slowEMA_values <span class="op">=</span> quarter_data[<span class="st">'spread_avratio'</span>].ewm(span <span class="op">=</span> slowEMA).mean()</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Insert NaNs wherever the original price is missing</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>                    fastEMA_values[quarter_data[<span class="st">'spread_avratio'</span>].isna()] <span class="op">=</span> np.nan</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>                    slowEMA_values[quarter_data[<span class="st">'spread_avratio'</span>].isna()] <span class="op">=</span> np.nan </span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate position for momentum strategy</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>                    cond2b_mom_long <span class="op">=</span> fastEMA_values.shift(<span class="dv">1</span>) <span class="op">&gt;</span> slowEMA_values.shift(<span class="dv">1</span>)</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># let's add filters that check for the presence of NaN values</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>                    fastEMA_nonmiss <span class="op">=</span> fastEMA_values.shift(<span class="dv">1</span>).notna()</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>                    slowEMA_nonmiss <span class="op">=</span> slowEMA_values.shift(<span class="dv">1</span>).notna()</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Now we can add these conditions to our strategies</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># if any of the values is missing,</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># we cannot make a position decision</span></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>                    pos_mom <span class="op">=</span> np.where(fastEMA_nonmiss <span class="op">&amp;</span> slowEMA_nonmiss,</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>                                       np.where(cond2b_mom_long, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>                                       np.nan)</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>                    pos_mr <span class="op">=</span> <span class="op">-</span>pos_mom </span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Set position to 0 where pos_flat is 1</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>                    pos_flat_quarter <span class="op">=</span> pos_flat[quarter_mask]</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>                    pos_mr[pos_flat_quarter <span class="op">==</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate gross pnl</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr <span class="op">=</span> pos_mr <span class="op">*</span> (quarter_data[<span class="st">'XAU'</span>].diff() <span class="op">-</span> quarter_data[<span class="st">'XAG'</span>].diff() <span class="op">*</span> quarter_data[<span class="st">'av_ratio'</span>])</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># point value for E6</span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate number of transactions</span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>                    ntrans <span class="op">=</span> np.<span class="bu">abs</span>(np.diff(pos_mom, prepend <span class="op">=</span> <span class="dv">0</span>))</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate net pnl</span></span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr <span class="op">=</span> pnl_gross_mr <span class="op">-</span> ntrans <span class="op">*</span> (<span class="dv">15</span> <span class="op">+</span> quarter_data[<span class="st">'av_ratio'</span>]<span class="op">*</span><span class="dv">10</span>)   <span class="co"># cost $10 per transaction on E6</span></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Aggregate to daily data</span></span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr <span class="op">=</span> pd.Series(pnl_gross_mr)</span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr.index <span class="op">=</span> quarter_data[<span class="st">'spread_avratio'</span>].index.time</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr_d <span class="op">=</span> pnl_gross_mr.groupby(quarter_data[<span class="st">'spread_avratio'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr <span class="op">=</span> pd.Series(pnl_net_mr)</span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr.index <span class="op">=</span> quarter_data[<span class="st">'spread_avratio'</span>].index.time</span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr_d <span class="op">=</span> pnl_net_mr.groupby(quarter_data[<span class="st">'spread_avratio'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>                    ntrans <span class="op">=</span> pd.Series(ntrans)</span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>                    ntrans.index <span class="op">=</span> quarter_data[<span class="st">'spread_avratio'</span>].index.time</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>                    ntrans_d <span class="op">=</span> ntrans.groupby(quarter_data[<span class="st">'spread_avratio'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate Sharpe Ratio and PnL</span></span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>                    gross_SR_mr <span class="op">=</span> mySR(pnl_gross_mr_d, scale<span class="op">=</span><span class="dv">252</span>)</span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a>                    net_SR_mr <span class="op">=</span> mySR(pnl_net_mr_d, scale<span class="op">=</span><span class="dv">252</span>)</span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>                    gross_PnL_mr <span class="op">=</span> pnl_gross_mr_d.<span class="bu">sum</span>()</span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>                    net_PnL_mr <span class="op">=</span> pnl_net_mr_d.<span class="bu">sum</span>()</span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a>                    av_daily_ntrans <span class="op">=</span> ntrans_d.mean()</span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Collect necessary results into one object</span></span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a>                    summary <span class="op">=</span> pd.DataFrame({</span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'fastEMA'</span>: fastEMA,</span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'slowEMA'</span>: slowEMA,</span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'quarter'</span>: quarter,</span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'gross_SR_mr'</span>: gross_SR_mr,</span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'net_SR_mr'</span>: net_SR_mr,</span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'gross_PnL_mr'</span>: gross_PnL_mr,</span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'net_PnL_mr'</span>: net_PnL_mr,</span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'av_daily_ntrans'</span>: av_daily_ntrans</span>
<span id="cb34-99"><a href="#cb34-99" aria-hidden="true" tabindex="-1"></a>                    }, index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb34-100"><a href="#cb34-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Append results to the summary</span></span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a>                    summary_all_2MAs <span class="op">=</span> pd.concat([summary_all_2MAs, summary], ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Processing quarter: 2023_Q1
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 150
  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 90
  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Processing quarter: 2023_Q3
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 240
  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 300
  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 90
  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240
  fastEMA = 60, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150
  fastEMA = 75, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120
  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 240
  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 420

Processing quarter: 2023_Q4
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240
  fastEMA = 20, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 300
  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360
  fastEMA = 45, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240
  fastEMA = 60, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150
  fastEMA = 75, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120
  fastEMA = 90, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240
  fastEMA = 90, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420

Processing quarter: 2024_Q2
  fastEMA = 15, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 300
  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 90
  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 150
  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 90
  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Processing quarter: 2024_Q4
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240
  fastEMA = 60, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150
  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 120
  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Processing quarter: 2025_Q1
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240
  fastEMA = 20, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300
  fastEMA = 30, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90
  fastEMA = 45, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360
  fastEMA = 45, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240
  fastEMA = 60, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150
  fastEMA = 75, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120
  fastEMA = 90, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240
  fastEMA = 90, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420

Processing quarter: 2025_Q2
  fastEMA = 15, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300
  fastEMA = 30, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90
  fastEMA = 45, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 360
  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150
  fastEMA = 60, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 240
  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90
  fastEMA = 75, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 150
  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 120
  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 240
  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 420</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create separate heatmaps for each quarter</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> quarter <span class="kw">in</span> quarters:</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    quarter_data <span class="op">=</span> summary_all_2MAs[summary_all_2MAs[<span class="st">'quarter'</span>] <span class="op">==</span> quarter]</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create figure with 2 subplots side by side</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">3</span>))</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot momentum strategy heatmap</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>    quarter_data_pivot_mom <span class="op">=</span> quarter_data.pivot(index<span class="op">=</span><span class="st">'fastEMA'</span>, columns<span class="op">=</span><span class="st">'slowEMA'</span>, values<span class="op">=</span><span class="st">'net_SR_mr'</span>)</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>    im1 <span class="op">=</span> axes[<span class="dv">0</span>].imshow(quarter_data_pivot_mom.values, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(quarter_data_pivot_mom.columns)))</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(quarter_data_pivot_mom.index)))</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(quarter_data_pivot_mom.columns)</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_yticklabels(quarter_data_pivot_mom.index)</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xlabel(<span class="st">'slowEMA'</span>)</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_ylabel(<span class="st">'fastEMA'</span>)</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="ss">f'Net Sharpe Ratio (Mean Reversion) - </span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>    plt.colorbar(im1, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot mean reversion strategy heatmap</span></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>    quarter_data_pivot_mr <span class="op">=</span> quarter_data.pivot(index<span class="op">=</span><span class="st">'fastEMA'</span>, columns<span class="op">=</span><span class="st">'slowEMA'</span>, values<span class="op">=</span><span class="st">'net_PnL_mr'</span>)</span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a>    im2 <span class="op">=</span> axes[<span class="dv">1</span>].imshow(quarter_data_pivot_mr.values, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(quarter_data_pivot_mr.columns)))</span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(quarter_data_pivot_mr.index)))</span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(quarter_data_pivot_mr.columns)</span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_yticklabels(quarter_data_pivot_mr.index)</span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xlabel(<span class="st">'slowEMA'</span>)</span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_ylabel(<span class="st">'fastEMA'</span>)</span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="ss">f'Net PnL(Mean Reversion) - </span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb158-30"><a href="#cb158-30" aria-hidden="true" tabindex="-1"></a>    plt.colorbar(im2, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb158-31"><a href="#cb158-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-32"><a href="#cb158-32" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb158-33"><a href="#cb158-33" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-63-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-63-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-63-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-63-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-63-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-63-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-63-output-7.png" class="img-fluid"></p>
</div>
</div>
<p>We can see that the results are not satisfactory - net Sharpe ratios are mostly negative. Let’s look at the spread based on returns.</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we check various parameter combinations in a loop</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mySR(x, scale):</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sqrt(scale) <span class="op">*</span> np.nanmean(x) <span class="op">/</span> np.nanstd(x)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>fastEMA_parameters <span class="op">=</span> [<span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">75</span>, <span class="dv">90</span>]</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>slowEMA_parameters <span class="op">=</span> [<span class="dv">90</span>, <span class="dv">120</span>, <span class="dv">150</span>, <span class="dv">180</span>, <span class="dv">240</span>, <span class="dv">300</span>, <span class="dv">360</span>, <span class="dv">420</span>]</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataframe to store results</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>summary_all_2MAs <span class="op">=</span> pd.DataFrame()</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each quarter</span></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> quarter <span class="kw">in</span> quarters:</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Processing quarter: </span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for the current quarter</span></span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>    quarter_mask <span class="op">=</span> all_data_2[<span class="st">'quarter'</span>] <span class="op">==</span> quarter</span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>    quarter_data <span class="op">=</span> all_data_2[quarter_mask].copy()</span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Loop over different parameter combinations</span></span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> fastEMA <span class="kw">in</span> fastEMA_parameters:</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> slowEMA <span class="kw">in</span> slowEMA_parameters:</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># ensure that fastEMA is less than slowEMA</span></span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> fastEMA <span class="op">&gt;=</span> slowEMA:</span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"  fastEMA = </span><span class="sc">{</span>fastEMA<span class="sc">}</span><span class="ss">, slowEMA = </span><span class="sc">{</span>slowEMA<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># We calculate the appropriate EMA</span></span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a>                    fastEMA_values <span class="op">=</span> quarter_data[<span class="st">'spread_sdsratio'</span>].ewm(span <span class="op">=</span> fastEMA).mean()</span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a>                    slowEMA_values <span class="op">=</span> quarter_data[<span class="st">'spread_sdsratio'</span>].ewm(span <span class="op">=</span> slowEMA).mean()</span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-34"><a href="#cb159-34" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Insert NaNs wherever the original price is missing</span></span>
<span id="cb159-35"><a href="#cb159-35" aria-hidden="true" tabindex="-1"></a>                    fastEMA_values[quarter_data[<span class="st">'spread_sdsratio'</span>].isna()] <span class="op">=</span> np.nan</span>
<span id="cb159-36"><a href="#cb159-36" aria-hidden="true" tabindex="-1"></a>                    slowEMA_values[quarter_data[<span class="st">'spread_sdsratio'</span>].isna()] <span class="op">=</span> np.nan </span>
<span id="cb159-37"><a href="#cb159-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-38"><a href="#cb159-38" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate position for momentum strategy</span></span>
<span id="cb159-39"><a href="#cb159-39" aria-hidden="true" tabindex="-1"></a>                    cond2b_mom_long <span class="op">=</span> fastEMA_values.shift(<span class="dv">1</span>) <span class="op">&gt;</span> slowEMA_values.shift(<span class="dv">1</span>)</span>
<span id="cb159-40"><a href="#cb159-40" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb159-41"><a href="#cb159-41" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># let's add filters that check for the presence of NaN values</span></span>
<span id="cb159-42"><a href="#cb159-42" aria-hidden="true" tabindex="-1"></a>                    fastEMA_nonmiss <span class="op">=</span> fastEMA_values.shift(<span class="dv">1</span>).notna()</span>
<span id="cb159-43"><a href="#cb159-43" aria-hidden="true" tabindex="-1"></a>                    slowEMA_nonmiss <span class="op">=</span> slowEMA_values.shift(<span class="dv">1</span>).notna()</span>
<span id="cb159-44"><a href="#cb159-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-45"><a href="#cb159-45" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Now we can add these conditions to our strategies</span></span>
<span id="cb159-46"><a href="#cb159-46" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># if any of the values is missing,</span></span>
<span id="cb159-47"><a href="#cb159-47" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># we cannot make a position decision</span></span>
<span id="cb159-48"><a href="#cb159-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-49"><a href="#cb159-49" aria-hidden="true" tabindex="-1"></a>                    pos_mom <span class="op">=</span> np.where(fastEMA_nonmiss <span class="op">&amp;</span> slowEMA_nonmiss,</span>
<span id="cb159-50"><a href="#cb159-50" aria-hidden="true" tabindex="-1"></a>                                       np.where(cond2b_mom_long, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb159-51"><a href="#cb159-51" aria-hidden="true" tabindex="-1"></a>                                       np.nan)</span>
<span id="cb159-52"><a href="#cb159-52" aria-hidden="true" tabindex="-1"></a>                    pos_mr <span class="op">=</span> <span class="op">-</span>pos_mom </span>
<span id="cb159-53"><a href="#cb159-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-54"><a href="#cb159-54" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Set position to 0 where pos_flat is 1</span></span>
<span id="cb159-55"><a href="#cb159-55" aria-hidden="true" tabindex="-1"></a>                    pos_flat_quarter <span class="op">=</span> pos_flat[quarter_mask]</span>
<span id="cb159-56"><a href="#cb159-56" aria-hidden="true" tabindex="-1"></a>                    pos_mr[pos_flat_quarter <span class="op">==</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb159-57"><a href="#cb159-57" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb159-58"><a href="#cb159-58" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate gross pnl</span></span>
<span id="cb159-59"><a href="#cb159-59" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr <span class="op">=</span> pos_mr <span class="op">*</span> (quarter_data[<span class="st">'XAU'</span>].diff() <span class="op">-</span> quarter_data[<span class="st">'XAG'</span>].diff() <span class="op">*</span> quarter_data[<span class="st">'sds_ratio'</span>])</span>
<span id="cb159-60"><a href="#cb159-60" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># point value for E6</span></span>
<span id="cb159-61"><a href="#cb159-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-62"><a href="#cb159-62" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate number of transactions</span></span>
<span id="cb159-63"><a href="#cb159-63" aria-hidden="true" tabindex="-1"></a>                    ntrans <span class="op">=</span> np.<span class="bu">abs</span>(np.diff(pos_mom, prepend <span class="op">=</span> <span class="dv">0</span>))</span>
<span id="cb159-64"><a href="#cb159-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-65"><a href="#cb159-65" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate net pnl</span></span>
<span id="cb159-66"><a href="#cb159-66" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr <span class="op">=</span> pnl_gross_mr <span class="op">-</span> ntrans <span class="op">*</span> (<span class="dv">15</span> <span class="op">+</span> quarter_data[<span class="st">'sds_ratio'</span>]<span class="op">*</span><span class="dv">10</span>)   <span class="co"># cost $10 per transaction on E6</span></span>
<span id="cb159-67"><a href="#cb159-67" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb159-68"><a href="#cb159-68" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Aggregate to daily data</span></span>
<span id="cb159-69"><a href="#cb159-69" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr <span class="op">=</span> pd.Series(pnl_gross_mr)</span>
<span id="cb159-70"><a href="#cb159-70" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr.index <span class="op">=</span> quarter_data[<span class="st">'spread_sdsratio'</span>].index.time</span>
<span id="cb159-71"><a href="#cb159-71" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr_d <span class="op">=</span> pnl_gross_mr.groupby(quarter_data[<span class="st">'spread_sdsratio'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb159-72"><a href="#cb159-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-73"><a href="#cb159-73" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr <span class="op">=</span> pd.Series(pnl_net_mr)</span>
<span id="cb159-74"><a href="#cb159-74" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr.index <span class="op">=</span> quarter_data[<span class="st">'spread_sdsratio'</span>].index.time</span>
<span id="cb159-75"><a href="#cb159-75" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr_d <span class="op">=</span> pnl_net_mr.groupby(quarter_data[<span class="st">'spread_sdsratio'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb159-76"><a href="#cb159-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-77"><a href="#cb159-77" aria-hidden="true" tabindex="-1"></a>                    ntrans <span class="op">=</span> pd.Series(ntrans)</span>
<span id="cb159-78"><a href="#cb159-78" aria-hidden="true" tabindex="-1"></a>                    ntrans.index <span class="op">=</span> quarter_data[<span class="st">'spread_sdsratio'</span>].index.time</span>
<span id="cb159-79"><a href="#cb159-79" aria-hidden="true" tabindex="-1"></a>                    ntrans_d <span class="op">=</span> ntrans.groupby(quarter_data[<span class="st">'spread_sdsratio'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb159-80"><a href="#cb159-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-81"><a href="#cb159-81" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate Sharpe Ratio and PnL</span></span>
<span id="cb159-82"><a href="#cb159-82" aria-hidden="true" tabindex="-1"></a>                    gross_SR_mr <span class="op">=</span> mySR(pnl_gross_mr_d, scale<span class="op">=</span><span class="dv">252</span>)</span>
<span id="cb159-83"><a href="#cb159-83" aria-hidden="true" tabindex="-1"></a>                    net_SR_mr <span class="op">=</span> mySR(pnl_net_mr_d, scale<span class="op">=</span><span class="dv">252</span>)</span>
<span id="cb159-84"><a href="#cb159-84" aria-hidden="true" tabindex="-1"></a>                    gross_PnL_mr <span class="op">=</span> pnl_gross_mr_d.<span class="bu">sum</span>()</span>
<span id="cb159-85"><a href="#cb159-85" aria-hidden="true" tabindex="-1"></a>                    net_PnL_mr <span class="op">=</span> pnl_net_mr_d.<span class="bu">sum</span>()</span>
<span id="cb159-86"><a href="#cb159-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-87"><a href="#cb159-87" aria-hidden="true" tabindex="-1"></a>                    av_daily_ntrans <span class="op">=</span> ntrans_d.mean()</span>
<span id="cb159-88"><a href="#cb159-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-89"><a href="#cb159-89" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Collect necessary results into one object</span></span>
<span id="cb159-90"><a href="#cb159-90" aria-hidden="true" tabindex="-1"></a>                    summary <span class="op">=</span> pd.DataFrame({</span>
<span id="cb159-91"><a href="#cb159-91" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'fastEMA'</span>: fastEMA,</span>
<span id="cb159-92"><a href="#cb159-92" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'slowEMA'</span>: slowEMA,</span>
<span id="cb159-93"><a href="#cb159-93" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'quarter'</span>: quarter,</span>
<span id="cb159-94"><a href="#cb159-94" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'gross_SR_mr'</span>: gross_SR_mr,</span>
<span id="cb159-95"><a href="#cb159-95" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'net_SR_mr'</span>: net_SR_mr,</span>
<span id="cb159-96"><a href="#cb159-96" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'gross_PnL_mr'</span>: gross_PnL_mr,</span>
<span id="cb159-97"><a href="#cb159-97" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'net_PnL_mr'</span>: net_PnL_mr,</span>
<span id="cb159-98"><a href="#cb159-98" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'av_daily_ntrans'</span>: av_daily_ntrans</span>
<span id="cb159-99"><a href="#cb159-99" aria-hidden="true" tabindex="-1"></a>                    }, index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb159-100"><a href="#cb159-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-101"><a href="#cb159-101" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Append results to the summary</span></span>
<span id="cb159-102"><a href="#cb159-102" aria-hidden="true" tabindex="-1"></a>                    summary_all_2MAs <span class="op">=</span> pd.concat([summary_all_2MAs, summary], ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Processing quarter: 2023_Q1
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240
  fastEMA = 20, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300
  fastEMA = 30, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90
  fastEMA = 45, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360
  fastEMA = 45, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240
  fastEMA = 60, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150
  fastEMA = 75, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120
  fastEMA = 90, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240
  fastEMA = 90, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420

Processing quarter: 2023_Q3
  fastEMA = 15, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 150
  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 90
  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Processing quarter: 2023_Q4
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 240
  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 150
  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 90
  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420

Processing quarter: 2024_Q2
  fastEMA = 15, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 150
  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 90
  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Processing quarter: 2024_Q4
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360
  fastEMA = 45, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240
  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90
  fastEMA = 75, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 150
  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Processing quarter: 2025_Q1
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 240
  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360
  fastEMA = 45, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240
  fastEMA = 60, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150
  fastEMA = 75, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120
  fastEMA = 90, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240
  fastEMA = 90, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420

Processing quarter: 2025_Q2
  fastEMA = 15, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300
  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 90
  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 360
  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 150
  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 90
  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-65-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-65-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-65-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-65-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-65-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-65-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-65-output-7.png" class="img-fluid"></p>
</div>
</div>
<p>The results are still not satisfactory - net Sharpe ratios are mostly negative. Therefore, we have decided to try volatility breakout strategy with momentum.</p>
</section>
<section id="volatility-breakout-model-1" class="level3">
<h3 class="anchored" data-anchor-id="volatility-breakout-model-1">Volatility breakout model</h3>
<p>Let’s take a look at the results of volatility breakout strategy with momentum on both spreads.</p>
<div class="cell" data-execution_count="66">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-67-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-67-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-67-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-67-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-67-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-67-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-67-output-7.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-68-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-68-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-68-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-68-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-68-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-68-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-68-output-7.png" class="img-fluid"></p>
</div>
</div>
<p>We can see that the volatility breakout model on spreads does not deliver satisfactory results either. Ofline, we also tried additional filtering, similarily to th eone conducted for group 1, but it did not improve performance. Therefore, we have decided to trade <strong>XAG</strong> alone.</p>
</section>
</section>
<section id="single-asset-strategies-1" class="level2">
<h2 class="anchored" data-anchor-id="single-asset-strategies-1">Single asset strategies</h2>
<p>After analyzing various strategies on spreads, we have decided to focus on trading <strong>XAG</strong> alone. We conducted a trial and error process with different parameter combinations, to find the most effective strategy.</p>
<section id="two-intersecting-moving-avarages-on-xag" class="level3">
<h3 class="anchored" data-anchor-id="two-intersecting-moving-avarages-on-xag">Two intersecting moving avarages on XAG</h3>
<p>First , we have tried two intersecting moving averages strategy on <strong>XAG</strong> prices. However, the results were not satisfactory, leading us to explore alternative strategies.</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mySR(x, scale):</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sqrt(scale) <span class="op">*</span> np.nanmean(x) <span class="op">/</span> np.nanstd(x)</span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>fastEMA_parameters <span class="op">=</span> [<span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">75</span>, <span class="dv">90</span>]</span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a>slowEMA_parameters <span class="op">=</span> [<span class="dv">90</span>, <span class="dv">120</span>, <span class="dv">150</span>, <span class="dv">180</span>, <span class="dv">240</span>, <span class="dv">300</span>, <span class="dv">360</span>, <span class="dv">420</span>]</span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create an empty DataFrame to store summary for all quarters</span></span>
<span id="cb285-8"><a href="#cb285-8" aria-hidden="true" tabindex="-1"></a>summary_2MAs <span class="op">=</span> pd.DataFrame()</span>
<span id="cb285-9"><a href="#cb285-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-10"><a href="#cb285-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> quarter <span class="kw">in</span> quarters:</span>
<span id="cb285-11"><a href="#cb285-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-12"><a href="#cb285-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Processing quarter: </span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb285-13"><a href="#cb285-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-14"><a href="#cb285-14" aria-hidden="true" tabindex="-1"></a>    data2 <span class="op">=</span> pd.read_parquet(<span class="ss">f'data/data2_</span><span class="sc">{</span>quarter<span class="sc">}</span><span class="ss">.parquet'</span>)</span>
<span id="cb285-15"><a href="#cb285-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-16"><a href="#cb285-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lets set the datetime index</span></span>
<span id="cb285-17"><a href="#cb285-17" aria-hidden="true" tabindex="-1"></a>    data2.set_index(<span class="st">'datetime'</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb285-18"><a href="#cb285-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-19"><a href="#cb285-19" aria-hidden="true" tabindex="-1"></a>    pos_flat <span class="op">=</span> np.zeros(<span class="bu">len</span>(data2))</span>
<span id="cb285-20"><a href="#cb285-20" aria-hidden="true" tabindex="-1"></a>    breaks <span class="op">=</span> (data2.index.time <span class="op">&gt;=</span> pd.to_datetime(<span class="st">"16:41"</span>).time()) <span class="op">&amp;</span> <span class="op">\</span></span>
<span id="cb285-21"><a href="#cb285-21" aria-hidden="true" tabindex="-1"></a>          (data2.index.time <span class="op">&lt;=</span> pd.to_datetime(<span class="st">"18:10"</span>).time())</span>
<span id="cb285-22"><a href="#cb285-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-23"><a href="#cb285-23" aria-hidden="true" tabindex="-1"></a>    pos_flat[breaks] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb285-24"><a href="#cb285-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-25"><a href="#cb285-25" aria-hidden="true" tabindex="-1"></a>    dweek_ <span class="op">=</span> data2.index.dayofweek <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb285-26"><a href="#cb285-26" aria-hidden="true" tabindex="-1"></a>    time_ <span class="op">=</span> data2.index.time</span>
<span id="cb285-27"><a href="#cb285-27" aria-hidden="true" tabindex="-1"></a>    pos_flat[((dweek_ <span class="op">==</span> <span class="dv">5</span>) <span class="op">&amp;</span> (time_ <span class="op">&gt;</span> pd.to_datetime(<span class="st">'17:00'</span>).time())) <span class="op">|</span>      <span class="co"># end of Friday</span></span>
<span id="cb285-28"><a href="#cb285-28" aria-hidden="true" tabindex="-1"></a>          (dweek_ <span class="op">==</span> <span class="dv">6</span>) <span class="op">|</span>                                                      <span class="co"># whole Saturday (just in case)</span></span>
<span id="cb285-29"><a href="#cb285-29" aria-hidden="true" tabindex="-1"></a>          ((dweek_ <span class="op">==</span> <span class="dv">7</span>) <span class="op">&amp;</span> (time_ <span class="op">&lt;=</span> pd.to_datetime(<span class="st">'18:00'</span>).time()))] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb285-30"><a href="#cb285-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-31"><a href="#cb285-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># apply the strategy</span></span>
<span id="cb285-32"><a href="#cb285-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">##############################################################</span></span>
<span id="cb285-33"><a href="#cb285-33" aria-hidden="true" tabindex="-1"></a>    XAG <span class="op">=</span> data2[<span class="st">'XAG'</span>]</span>
<span id="cb285-34"><a href="#cb285-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-35"><a href="#cb285-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> fastEMA <span class="kw">in</span> fastEMA_parameters:</span>
<span id="cb285-36"><a href="#cb285-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> slowEMA <span class="kw">in</span> slowEMA_parameters:</span>
<span id="cb285-37"><a href="#cb285-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-38"><a href="#cb285-38" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># ensure that fastEMA is less than slowEMA</span></span>
<span id="cb285-39"><a href="#cb285-39" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> fastEMA <span class="op">&gt;=</span> slowEMA:</span>
<span id="cb285-40"><a href="#cb285-40" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb285-41"><a href="#cb285-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-42"><a href="#cb285-42" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"  fastEMA = </span><span class="sc">{</span>fastEMA<span class="sc">}</span><span class="ss">, slowEMA = </span><span class="sc">{</span>slowEMA<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb285-43"><a href="#cb285-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-44"><a href="#cb285-44" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># We calculate the appropriate EMA</span></span>
<span id="cb285-45"><a href="#cb285-45" aria-hidden="true" tabindex="-1"></a>                    fastEMA_values <span class="op">=</span> XAG.ewm(span <span class="op">=</span> fastEMA).mean()</span>
<span id="cb285-46"><a href="#cb285-46" aria-hidden="true" tabindex="-1"></a>                    slowEMA_values <span class="op">=</span> XAG.ewm(span<span class="op">=</span> slowEMA).mean()</span>
<span id="cb285-47"><a href="#cb285-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-48"><a href="#cb285-48" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Insert NaNs wherever the original price is missing</span></span>
<span id="cb285-49"><a href="#cb285-49" aria-hidden="true" tabindex="-1"></a>                    fastEMA_values[data2[<span class="st">'XAG'</span>].isna()] <span class="op">=</span> np.nan</span>
<span id="cb285-50"><a href="#cb285-50" aria-hidden="true" tabindex="-1"></a>                    slowEMA_values[data2[<span class="st">'XAG'</span>].isna()] <span class="op">=</span> np.nan</span>
<span id="cb285-51"><a href="#cb285-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-52"><a href="#cb285-52" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate position for momentum strategy</span></span>
<span id="cb285-53"><a href="#cb285-53" aria-hidden="true" tabindex="-1"></a>                    cond2b_mom_long <span class="op">=</span> fastEMA_values.shift(<span class="dv">1</span>) <span class="op">&gt;</span> slowEMA_values.shift(<span class="dv">1</span>)</span>
<span id="cb285-54"><a href="#cb285-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-55"><a href="#cb285-55" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># let's add filters that check for the presence of NaN values</span></span>
<span id="cb285-56"><a href="#cb285-56" aria-hidden="true" tabindex="-1"></a>                    fastEMA_nonmiss <span class="op">=</span> fastEMA_values.shift(<span class="dv">1</span>).notna()</span>
<span id="cb285-57"><a href="#cb285-57" aria-hidden="true" tabindex="-1"></a>                    slowEMA_nonmiss <span class="op">=</span> slowEMA_values.shift(<span class="dv">1</span>).notna()</span>
<span id="cb285-58"><a href="#cb285-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-59"><a href="#cb285-59" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Now we can add these conditions to our strategies</span></span>
<span id="cb285-60"><a href="#cb285-60" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># if any of the values is missing,</span></span>
<span id="cb285-61"><a href="#cb285-61" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># we cannot make a position decision</span></span>
<span id="cb285-62"><a href="#cb285-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-63"><a href="#cb285-63" aria-hidden="true" tabindex="-1"></a>                    pos_mom <span class="op">=</span> np.where(fastEMA_nonmiss <span class="op">&amp;</span> slowEMA_nonmiss,</span>
<span id="cb285-64"><a href="#cb285-64" aria-hidden="true" tabindex="-1"></a>                                       np.where(cond2b_mom_long, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb285-65"><a href="#cb285-65" aria-hidden="true" tabindex="-1"></a>                                       np.nan)</span>
<span id="cb285-66"><a href="#cb285-66" aria-hidden="true" tabindex="-1"></a>                    pos_mr <span class="op">=</span> <span class="op">-</span>pos_mom</span>
<span id="cb285-67"><a href="#cb285-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-68"><a href="#cb285-68" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Set position to 0 where pos_flat is 1</span></span>
<span id="cb285-69"><a href="#cb285-69" aria-hidden="true" tabindex="-1"></a>                    pos_mom[pos_flat <span class="op">==</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb285-70"><a href="#cb285-70" aria-hidden="true" tabindex="-1"></a>                    pos_mr[pos_flat <span class="op">==</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb285-71"><a href="#cb285-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-72"><a href="#cb285-72" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate gross pnl</span></span>
<span id="cb285-73"><a href="#cb285-73" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mom <span class="op">=</span> np.where(np.isnan(pos_mom <span class="op">*</span> data2[<span class="st">"XAG"</span>].diff()), <span class="dv">0</span>, pos_mom <span class="op">*</span> data2[<span class="st">"XAG"</span>].diff() <span class="op">*</span> <span class="dv">5000</span>)</span>
<span id="cb285-74"><a href="#cb285-74" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr <span class="op">=</span> np.where(np.isnan(pos_mr <span class="op">*</span> data2[<span class="st">"XAG"</span>].diff()), <span class="dv">0</span>, pos_mr <span class="op">*</span> data2[<span class="st">"XAG"</span>].diff() <span class="op">*</span> <span class="dv">5000</span>)</span>
<span id="cb285-75"><a href="#cb285-75" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># point value for XAG</span></span>
<span id="cb285-76"><a href="#cb285-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-77"><a href="#cb285-77" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate number of transactions</span></span>
<span id="cb285-78"><a href="#cb285-78" aria-hidden="true" tabindex="-1"></a>                    ntrans <span class="op">=</span> np.<span class="bu">abs</span>(np.diff(pos_mom, prepend <span class="op">=</span> <span class="dv">0</span>))</span>
<span id="cb285-79"><a href="#cb285-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-80"><a href="#cb285-80" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate net pnl</span></span>
<span id="cb285-81"><a href="#cb285-81" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mom <span class="op">=</span> pnl_gross_mom <span class="op">-</span> ntrans <span class="op">*</span> <span class="dv">10</span> <span class="co"># cost $12 per transaction</span></span>
<span id="cb285-82"><a href="#cb285-82" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr <span class="op">=</span> pnl_gross_mr <span class="op">-</span> ntrans <span class="op">*</span> <span class="dv">10</span>   <span class="co"># cost $12 per transaction</span></span>
<span id="cb285-83"><a href="#cb285-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-84"><a href="#cb285-84" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Aggregate to daily data</span></span>
<span id="cb285-85"><a href="#cb285-85" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mom <span class="op">=</span> pd.Series(pnl_gross_mom)</span>
<span id="cb285-86"><a href="#cb285-86" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mom.index <span class="op">=</span> data2[<span class="st">'XAG'</span>].index.time</span>
<span id="cb285-87"><a href="#cb285-87" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mom_d <span class="op">=</span> pnl_gross_mom.groupby(data2[<span class="st">'XAG'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb285-88"><a href="#cb285-88" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr <span class="op">=</span> pd.Series(pnl_gross_mr)</span>
<span id="cb285-89"><a href="#cb285-89" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr.index <span class="op">=</span> data2[<span class="st">'XAG'</span>].index.time</span>
<span id="cb285-90"><a href="#cb285-90" aria-hidden="true" tabindex="-1"></a>                    pnl_gross_mr_d <span class="op">=</span> pnl_gross_mr.groupby(data2[<span class="st">'XAG'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb285-91"><a href="#cb285-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-92"><a href="#cb285-92" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mom <span class="op">=</span> pd.Series(pnl_net_mom)</span>
<span id="cb285-93"><a href="#cb285-93" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mom.index <span class="op">=</span> data2[<span class="st">'XAG'</span>].index.time</span>
<span id="cb285-94"><a href="#cb285-94" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mom_d <span class="op">=</span> pnl_net_mom.groupby(data2[<span class="st">'XAG'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb285-95"><a href="#cb285-95" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr <span class="op">=</span> pd.Series(pnl_net_mr)</span>
<span id="cb285-96"><a href="#cb285-96" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr.index <span class="op">=</span> data2[<span class="st">'XAG'</span>].index.time</span>
<span id="cb285-97"><a href="#cb285-97" aria-hidden="true" tabindex="-1"></a>                    pnl_net_mr_d <span class="op">=</span> pnl_net_mr.groupby(data2[<span class="st">'XAG'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb285-98"><a href="#cb285-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-99"><a href="#cb285-99" aria-hidden="true" tabindex="-1"></a>                    ntrans <span class="op">=</span> pd.Series(ntrans)</span>
<span id="cb285-100"><a href="#cb285-100" aria-hidden="true" tabindex="-1"></a>                    ntrans.index <span class="op">=</span> data2[<span class="st">'XAG'</span>].index.time</span>
<span id="cb285-101"><a href="#cb285-101" aria-hidden="true" tabindex="-1"></a>                    ntrans_d <span class="op">=</span> ntrans.groupby(data2[<span class="st">'XAG'</span>].index.date).<span class="bu">sum</span>()</span>
<span id="cb285-102"><a href="#cb285-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-103"><a href="#cb285-103" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate Sharpe Ratio and PnL</span></span>
<span id="cb285-104"><a href="#cb285-104" aria-hidden="true" tabindex="-1"></a>                    gross_SR_mom <span class="op">=</span> mySR(pnl_gross_mom_d, scale<span class="op">=</span><span class="dv">252</span>)</span>
<span id="cb285-105"><a href="#cb285-105" aria-hidden="true" tabindex="-1"></a>                    net_SR_mom <span class="op">=</span> mySR(pnl_net_mom_d, scale<span class="op">=</span><span class="dv">252</span>)</span>
<span id="cb285-106"><a href="#cb285-106" aria-hidden="true" tabindex="-1"></a>                    gross_PnL_mom <span class="op">=</span> pnl_gross_mom_d.<span class="bu">sum</span>()</span>
<span id="cb285-107"><a href="#cb285-107" aria-hidden="true" tabindex="-1"></a>                    net_PnL_mom <span class="op">=</span> pnl_net_mom_d.<span class="bu">sum</span>()</span>
<span id="cb285-108"><a href="#cb285-108" aria-hidden="true" tabindex="-1"></a>                    gross_SR_mr <span class="op">=</span> mySR(pnl_gross_mr_d, scale<span class="op">=</span><span class="dv">252</span>)</span>
<span id="cb285-109"><a href="#cb285-109" aria-hidden="true" tabindex="-1"></a>                    net_SR_mr <span class="op">=</span> mySR(pnl_net_mr_d, scale<span class="op">=</span><span class="dv">252</span>)</span>
<span id="cb285-110"><a href="#cb285-110" aria-hidden="true" tabindex="-1"></a>                    gross_PnL_mr <span class="op">=</span> pnl_gross_mr_d.<span class="bu">sum</span>()</span>
<span id="cb285-111"><a href="#cb285-111" aria-hidden="true" tabindex="-1"></a>                    net_PnL_mr <span class="op">=</span> pnl_net_mr_d.<span class="bu">sum</span>()</span>
<span id="cb285-112"><a href="#cb285-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-113"><a href="#cb285-113" aria-hidden="true" tabindex="-1"></a>                    av_daily_ntrans <span class="op">=</span> ntrans_d.mean()</span>
<span id="cb285-114"><a href="#cb285-114" aria-hidden="true" tabindex="-1"></a>                    stat_mom <span class="op">=</span> (net_SR_mom <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">*</span> np.maximum(<span class="dv">0</span>, np.log(np.<span class="bu">abs</span>(net_PnL_mom<span class="op">/</span><span class="dv">1000</span>)))</span>
<span id="cb285-115"><a href="#cb285-115" aria-hidden="true" tabindex="-1"></a>                    stat_mr <span class="op">=</span> (net_SR_mr <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">*</span> np.maximum(<span class="dv">0</span>, np.log(np.<span class="bu">abs</span>(net_PnL_mr<span class="op">/</span><span class="dv">1000</span>)))</span>
<span id="cb285-116"><a href="#cb285-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-117"><a href="#cb285-117" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Collect necessary results into one object</span></span>
<span id="cb285-118"><a href="#cb285-118" aria-hidden="true" tabindex="-1"></a>                    summary <span class="op">=</span> pd.DataFrame({</span>
<span id="cb285-119"><a href="#cb285-119" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'fastEMA'</span>: fastEMA,</span>
<span id="cb285-120"><a href="#cb285-120" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'slowEMA'</span>: slowEMA,</span>
<span id="cb285-121"><a href="#cb285-121" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'quarter'</span>: quarter,</span>
<span id="cb285-122"><a href="#cb285-122" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'gross_SR_mom'</span>: gross_SR_mom,</span>
<span id="cb285-123"><a href="#cb285-123" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'net_SR_mom'</span>: net_SR_mom,</span>
<span id="cb285-124"><a href="#cb285-124" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'gross_PnL_mom'</span>: gross_PnL_mom,</span>
<span id="cb285-125"><a href="#cb285-125" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'net_PnL_mom'</span>: net_PnL_mom,</span>
<span id="cb285-126"><a href="#cb285-126" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'gross_SR_mr'</span>: gross_SR_mr,</span>
<span id="cb285-127"><a href="#cb285-127" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'net_SR_mr'</span>: net_SR_mr,</span>
<span id="cb285-128"><a href="#cb285-128" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'gross_PnL_mr'</span>: gross_PnL_mr,</span>
<span id="cb285-129"><a href="#cb285-129" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'net_PnL_mr'</span>: net_PnL_mr,</span>
<span id="cb285-130"><a href="#cb285-130" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'av_daily_ntrans'</span>: av_daily_ntrans,</span>
<span id="cb285-131"><a href="#cb285-131" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'stat_mom'</span>: stat_mom,</span>
<span id="cb285-132"><a href="#cb285-132" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'stat_mr'</span>: stat_mr</span>
<span id="cb285-133"><a href="#cb285-133" aria-hidden="true" tabindex="-1"></a>                    }, index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb285-134"><a href="#cb285-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-135"><a href="#cb285-135" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Append results to the summary</span></span>
<span id="cb285-136"><a href="#cb285-136" aria-hidden="true" tabindex="-1"></a>                    summary_2MAs <span class="op">=</span> pd.concat([summary_2MAs, summary], ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2023_Q1
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 240
  fastEMA = 20, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 90
  fastEMA = 45, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 360
  fastEMA = 45, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 90
  fastEMA = 60, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 150
  fastEMA = 60, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 240
  fastEMA = 60, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 90
  fastEMA = 75, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 150
  fastEMA = 75, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 120
  fastEMA = 90, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 420
Processing quarter: 2023_Q3
  fastEMA = 15, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 300
  fastEMA = 30, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 240
  fastEMA = 90, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2023_Q4
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 240
  fastEMA = 20, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 90
  fastEMA = 45, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 240
  fastEMA = 90, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2024_Q2
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 240
  fastEMA = 20, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 90
  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 120
  fastEMA = 90, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 420
Processing quarter: 2024_Q4
  fastEMA = 15, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 300
  fastEMA = 30, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360
  fastEMA = 60, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 90
  fastEMA = 75, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 150
  fastEMA = 75, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 240
  fastEMA = 75, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 360
  fastEMA = 75, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 120
  fastEMA = 90, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 180
  fastEMA = 90, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 300
  fastEMA = 90, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 420
Processing quarter: 2025_Q1
  fastEMA = 15, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 120
  fastEMA = 15, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 180
  fastEMA = 15, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 300
  fastEMA = 15, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 420
  fastEMA = 20, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 120
  fastEMA = 20, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 180
  fastEMA = 20, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 300
  fastEMA = 20, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 420
  fastEMA = 30, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 120
  fastEMA = 30, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 180
  fastEMA = 30, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 300
  fastEMA = 30, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 420
  fastEMA = 45, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 120
  fastEMA = 45, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 180
  fastEMA = 45, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 240
  fastEMA = 90, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing quarter: 2025_Q2
  fastEMA = 15, slowEMA = 90
  fastEMA = 15, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 150
  fastEMA = 15, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 240
  fastEMA = 15, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 15, slowEMA = 360
  fastEMA = 15, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 90
  fastEMA = 20, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 150
  fastEMA = 20, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 240
  fastEMA = 20, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 20, slowEMA = 360
  fastEMA = 20, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 90
  fastEMA = 30, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 150
  fastEMA = 30, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 240
  fastEMA = 30, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 30, slowEMA = 360
  fastEMA = 30, slowEMA = 420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 90
  fastEMA = 45, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 150
  fastEMA = 45, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 240
  fastEMA = 45, slowEMA = 300
  fastEMA = 45, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 45, slowEMA = 420
  fastEMA = 60, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 120
  fastEMA = 60, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 180
  fastEMA = 60, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 300
  fastEMA = 60, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 60, slowEMA = 420
  fastEMA = 75, slowEMA = 90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 120
  fastEMA = 75, slowEMA = 150</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 180
  fastEMA = 75, slowEMA = 240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 300
  fastEMA = 75, slowEMA = 360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 75, slowEMA = 420
  fastEMA = 90, slowEMA = 120</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 150
  fastEMA = 90, slowEMA = 180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 240
  fastEMA = 90, slowEMA = 300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  fastEMA = 90, slowEMA = 360
  fastEMA = 90, slowEMA = 420</code></pre>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a>aggregated_stats_2MAs <span class="op">=</span> (</span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a>    summary_2MAs</span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">'fastEMA'</span>, <span class="st">'slowEMA'</span>], as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb476-5"><a href="#cb476-5" aria-hidden="true" tabindex="-1"></a>        stat_mom_total<span class="op">=</span>(<span class="st">'stat_mom'</span>, <span class="st">'sum'</span>),</span>
<span id="cb476-6"><a href="#cb476-6" aria-hidden="true" tabindex="-1"></a>        stat_mr_total<span class="op">=</span>(<span class="st">'stat_mr'</span>, <span class="st">'sum'</span>),</span>
<span id="cb476-7"><a href="#cb476-7" aria-hidden="true" tabindex="-1"></a>        quarters_count<span class="op">=</span>(<span class="st">'quarter'</span>, <span class="st">'nunique'</span>),</span>
<span id="cb476-8"><a href="#cb476-8" aria-hidden="true" tabindex="-1"></a>        net_SR_mom_mean<span class="op">=</span>(<span class="st">'net_SR_mom'</span>, <span class="st">'mean'</span>),</span>
<span id="cb476-9"><a href="#cb476-9" aria-hidden="true" tabindex="-1"></a>        net_SR_mr_mean<span class="op">=</span>(<span class="st">'net_SR_mr'</span>, <span class="st">'mean'</span>),</span>
<span id="cb476-10"><a href="#cb476-10" aria-hidden="true" tabindex="-1"></a>        net_PnL_mom_total<span class="op">=</span>(<span class="st">'net_PnL_mom'</span>, <span class="st">'sum'</span>),</span>
<span id="cb476-11"><a href="#cb476-11" aria-hidden="true" tabindex="-1"></a>        net_PnL_mr_total<span class="op">=</span>(<span class="st">'net_PnL_mr'</span>, <span class="st">'sum'</span>),</span>
<span id="cb476-12"><a href="#cb476-12" aria-hidden="true" tabindex="-1"></a>        av_daily_ntrans_mean<span class="op">=</span>(<span class="st">'av_daily_ntrans'</span>, <span class="st">'mean'</span>)</span>
<span id="cb476-13"><a href="#cb476-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb476-14"><a href="#cb476-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb476-15"><a href="#cb476-15" aria-hidden="true" tabindex="-1"></a>aggregated_stats_2MAs[<span class="st">'stat_mom_total'</span>] <span class="op">=</span> aggregated_stats_2MAs[<span class="st">'stat_mom_total'</span>].<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb476-16"><a href="#cb476-16" aria-hidden="true" tabindex="-1"></a>aggregated_stats_2MAs[<span class="st">'stat_mr_total'</span>] <span class="op">=</span> aggregated_stats_2MAs[<span class="st">'stat_mr_total'</span>].<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb476-17"><a href="#cb476-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-18"><a href="#cb476-18" aria-hidden="true" tabindex="-1"></a>plot_heatmap(</span>
<span id="cb476-19"><a href="#cb476-19" aria-hidden="true" tabindex="-1"></a>    df<span class="op">=</span>aggregated_stats_2MAs,</span>
<span id="cb476-20"><a href="#cb476-20" aria-hidden="true" tabindex="-1"></a>    value_col<span class="op">=</span><span class="st">'stat_mom_total'</span>,</span>
<span id="cb476-21"><a href="#cb476-21" aria-hidden="true" tabindex="-1"></a>    index_col<span class="op">=</span><span class="st">'fastEMA'</span>,</span>
<span id="cb476-22"><a href="#cb476-22" aria-hidden="true" tabindex="-1"></a>    columns_col<span class="op">=</span><span class="st">'slowEMA'</span>,</span>
<span id="cb476-23"><a href="#cb476-23" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Aggregated Stat Momentum over all quarters'</span>,</span>
<span id="cb476-24"><a href="#cb476-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="final_report%20(1)_files/figure-html/cell-70-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="finally-selected-strategy-for-group-2" class="level2">
<h2 class="anchored" data-anchor-id="finally-selected-strategy-for-group-2">Finally selected strategy for <strong>group 2</strong></h2>
<p>As a result of the trial and error process, we have ended with volatility breakout model with momentum strategy for <strong>XAG</strong> with signal and slow EMA of 30 and 240 respectively. The window length used in volatilities calculation was set to 60, while the multiplier for lower and upper threshold was set to 1. The stop-loss assumption was set as maximum of $1000 loss per day.</p>
</section>
<section id="summary-of-results-for-group-2" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-results-for-group-2">Summary of results for <strong>group 2</strong></h2>
<!-- here you can include code chunk that applies the strategy for group 1 and calculates all the summary statistics
-->
<div class="cell" data-execution_count="71">
<div class="cell-output cell-output-display" data-execution_count="71">

<style type="text/css">
#T_c4106 th {
  font-size: 20px;
}
#T_c4106 td {
  font-size: 20px;
}
#T_c4106_row0_col0, #T_c4106_row0_col1, #T_c4106_row0_col2, #T_c4106_row0_col3, #T_c4106_row0_col4, #T_c4106_row0_col5, #T_c4106_row0_col6, #T_c4106_row0_col7, #T_c4106_row0_col8, #T_c4106_row1_col0, #T_c4106_row1_col1, #T_c4106_row1_col2, #T_c4106_row1_col3, #T_c4106_row1_col4, #T_c4106_row1_col5, #T_c4106_row1_col6, #T_c4106_row1_col7, #T_c4106_row1_col8, #T_c4106_row2_col0, #T_c4106_row2_col1, #T_c4106_row2_col2, #T_c4106_row2_col3, #T_c4106_row2_col4, #T_c4106_row2_col5, #T_c4106_row2_col6, #T_c4106_row2_col7, #T_c4106_row2_col8, #T_c4106_row3_col0, #T_c4106_row3_col1, #T_c4106_row3_col2, #T_c4106_row3_col3, #T_c4106_row3_col4, #T_c4106_row3_col5, #T_c4106_row3_col6, #T_c4106_row3_col7, #T_c4106_row3_col8, #T_c4106_row4_col0, #T_c4106_row4_col1, #T_c4106_row4_col2, #T_c4106_row4_col3, #T_c4106_row4_col4, #T_c4106_row4_col5, #T_c4106_row4_col6, #T_c4106_row4_col7, #T_c4106_row4_col8, #T_c4106_row5_col0, #T_c4106_row5_col1, #T_c4106_row5_col2, #T_c4106_row5_col3, #T_c4106_row5_col4, #T_c4106_row5_col5, #T_c4106_row5_col6, #T_c4106_row5_col7, #T_c4106_row5_col8, #T_c4106_row6_col0, #T_c4106_row6_col1, #T_c4106_row6_col2, #T_c4106_row6_col3, #T_c4106_row6_col4, #T_c4106_row6_col5, #T_c4106_row6_col6, #T_c4106_row6_col7, #T_c4106_row6_col8, #T_c4106_row7_col0, #T_c4106_row7_col1, #T_c4106_row7_col2, #T_c4106_row7_col3, #T_c4106_row7_col4, #T_c4106_row7_col5, #T_c4106_row7_col6, #T_c4106_row7_col7, #T_c4106_row7_col8, #T_c4106_row8_col0, #T_c4106_row8_col1, #T_c4106_row8_col2, #T_c4106_row8_col3, #T_c4106_row8_col4, #T_c4106_row8_col5, #T_c4106_row8_col6, #T_c4106_row8_col7, #T_c4106_row8_col8, #T_c4106_row9_col0, #T_c4106_row9_col1, #T_c4106_row9_col2, #T_c4106_row9_col3, #T_c4106_row9_col4, #T_c4106_row9_col5, #T_c4106_row9_col6, #T_c4106_row9_col7, #T_c4106_row9_col8, #T_c4106_row10_col0, #T_c4106_row10_col1, #T_c4106_row10_col2, #T_c4106_row10_col3, #T_c4106_row10_col4, #T_c4106_row10_col5, #T_c4106_row10_col6, #T_c4106_row10_col7, #T_c4106_row10_col8, #T_c4106_row11_col0, #T_c4106_row11_col1, #T_c4106_row11_col2, #T_c4106_row11_col3, #T_c4106_row11_col4, #T_c4106_row11_col5, #T_c4106_row11_col6, #T_c4106_row11_col7, #T_c4106_row11_col8 {
  text-align: right;
}
</style>
<table id="T_c4106">
  <thead>
    <tr>
      <th id="T_c4106_level0_col0" class="col_heading level0 col0">quarter</th>
      <th id="T_c4106_level0_col1" class="col_heading level0 col1">gross_SR</th>
      <th id="T_c4106_level0_col2" class="col_heading level0 col2">net_SR</th>
      <th id="T_c4106_level0_col3" class="col_heading level0 col3">gross_PnL</th>
      <th id="T_c4106_level0_col4" class="col_heading level0 col4">net_PnL</th>
      <th id="T_c4106_level0_col5" class="col_heading level0 col5">gross_CR</th>
      <th id="T_c4106_level0_col6" class="col_heading level0 col6">net_CR</th>
      <th id="T_c4106_level0_col7" class="col_heading level0 col7">av_daily_ntrans</th>
      <th id="T_c4106_level0_col8" class="col_heading level0 col8">stat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_c4106_row0_col0" class="data row0 col0">2023_Q1</td>
      <td id="T_c4106_row0_col1" class="data row0 col1">2.06</td>
      <td id="T_c4106_row0_col2" class="data row0 col2">1.84</td>
      <td id="T_c4106_row0_col3" class="data row0 col3">14485.00</td>
      <td id="T_c4106_row0_col4" class="data row0 col4">12985.00</td>
      <td id="T_c4106_row0_col5" class="data row0 col5">6.38</td>
      <td id="T_c4106_row0_col6" class="data row0 col6">5.82</td>
      <td id="T_c4106_row0_col7" class="data row0 col7">1.92</td>
      <td id="T_c4106_row0_col8" class="data row0 col8">3.44</td>
    </tr>
    <tr>
      <td id="T_c4106_row1_col0" class="data row1 col0">2023_Q2</td>
      <td id="T_c4106_row1_col1" class="data row1 col1">0.76</td>
      <td id="T_c4106_row1_col2" class="data row1 col2">0.49</td>
      <td id="T_c4106_row1_col3" class="data row1 col3">4470.00</td>
      <td id="T_c4106_row1_col4" class="data row1 col4">2890.00</td>
      <td id="T_c4106_row1_col5" class="data row1 col5">1.99</td>
      <td id="T_c4106_row1_col6" class="data row1 col6">1.47</td>
      <td id="T_c4106_row1_col7" class="data row1 col7">2.05</td>
      <td id="T_c4106_row1_col8" class="data row1 col8">-0.01</td>
    </tr>
    <tr>
      <td id="T_c4106_row2_col0" class="data row2 col0">2023_Q3</td>
      <td id="T_c4106_row2_col1" class="data row2 col1">5.02</td>
      <td id="T_c4106_row2_col2" class="data row2 col2">4.75</td>
      <td id="T_c4106_row2_col3" class="data row2 col3">27830.00</td>
      <td id="T_c4106_row2_col4" class="data row2 col4">26350.00</td>
      <td id="T_c4106_row2_col5" class="data row2 col5">47.23</td>
      <td id="T_c4106_row2_col6" class="data row2 col6">43.64</td>
      <td id="T_c4106_row2_col7" class="data row2 col7">1.90</td>
      <td id="T_c4106_row2_col8" class="data row2 col8">13.91</td>
    </tr>
    <tr>
      <td id="T_c4106_row3_col0" class="data row3 col0">2023_Q4</td>
      <td id="T_c4106_row3_col1" class="data row3 col1">2.61</td>
      <td id="T_c4106_row3_col2" class="data row3 col2">2.37</td>
      <td id="T_c4106_row3_col3" class="data row3 col3">15145.00</td>
      <td id="T_c4106_row3_col4" class="data row3 col4">13745.00</td>
      <td id="T_c4106_row3_col5" class="data row3 col5">10.20</td>
      <td id="T_c4106_row3_col6" class="data row3 col6">8.98</td>
      <td id="T_c4106_row3_col7" class="data row3 col7">1.79</td>
      <td id="T_c4106_row3_col8" class="data row3 col8">4.90</td>
    </tr>
    <tr>
      <td id="T_c4106_row4_col0" class="data row4 col0">2024_Q1</td>
      <td id="T_c4106_row4_col1" class="data row4 col1">0.62</td>
      <td id="T_c4106_row4_col2" class="data row4 col2">0.31</td>
      <td id="T_c4106_row4_col3" class="data row4 col3">3265.00</td>
      <td id="T_c4106_row4_col4" class="data row4 col4">1645.00</td>
      <td id="T_c4106_row4_col5" class="data row4 col5">1.98</td>
      <td id="T_c4106_row4_col6" class="data row4 col6">1.30</td>
      <td id="T_c4106_row4_col7" class="data row4 col7">2.08</td>
      <td id="T_c4106_row4_col8" class="data row4 col8">-0.09</td>
    </tr>
    <tr>
      <td id="T_c4106_row5_col0" class="data row5 col0">2024_Q2</td>
      <td id="T_c4106_row5_col1" class="data row5 col1">3.20</td>
      <td id="T_c4106_row5_col2" class="data row5 col2">3.06</td>
      <td id="T_c4106_row5_col3" class="data row5 col3">29715.00</td>
      <td id="T_c4106_row5_col4" class="data row5 col4">28325.00</td>
      <td id="T_c4106_row5_col5" class="data row5 col5">16.50</td>
      <td id="T_c4106_row5_col6" class="data row5 col6">15.72</td>
      <td id="T_c4106_row5_col7" class="data row5 col7">1.78</td>
      <td id="T_c4106_row5_col8" class="data row5 col8">8.54</td>
    </tr>
    <tr>
      <td id="T_c4106_row6_col0" class="data row6 col0">2024_Q3</td>
      <td id="T_c4106_row6_col1" class="data row6 col1">3.93</td>
      <td id="T_c4106_row6_col2" class="data row6 col2">3.75</td>
      <td id="T_c4106_row6_col3" class="data row6 col3">30025.00</td>
      <td id="T_c4106_row6_col4" class="data row6 col4">28665.00</td>
      <td id="T_c4106_row6_col5" class="data row6 col5">32.27</td>
      <td id="T_c4106_row6_col6" class="data row6 col6">30.98</td>
      <td id="T_c4106_row6_col7" class="data row6 col7">1.72</td>
      <td id="T_c4106_row6_col8" class="data row6 col8">10.91</td>
    </tr>
    <tr>
      <td id="T_c4106_row7_col0" class="data row7 col0">2024_Q4</td>
      <td id="T_c4106_row7_col1" class="data row7 col1">2.17</td>
      <td id="T_c4106_row7_col2" class="data row7 col2">2.03</td>
      <td id="T_c4106_row7_col3" class="data row7 col3">19780.00</td>
      <td id="T_c4106_row7_col4" class="data row7 col4">18440.00</td>
      <td id="T_c4106_row7_col5" class="data row7 col5">11.89</td>
      <td id="T_c4106_row7_col6" class="data row7 col6">11.18</td>
      <td id="T_c4106_row7_col7" class="data row7 col7">1.70</td>
      <td id="T_c4106_row7_col8" class="data row7 col8">4.46</td>
    </tr>
    <tr>
      <td id="T_c4106_row8_col0" class="data row8 col0">2025_Q1</td>
      <td id="T_c4106_row8_col1" class="data row8 col1">3.27</td>
      <td id="T_c4106_row8_col2" class="data row8 col2">3.05</td>
      <td id="T_c4106_row8_col3" class="data row8 col3">20970.00</td>
      <td id="T_c4106_row8_col4" class="data row8 col4">19530.00</td>
      <td id="T_c4106_row8_col5" class="data row8 col5">17.15</td>
      <td id="T_c4106_row8_col6" class="data row8 col6">15.88</td>
      <td id="T_c4106_row8_col7" class="data row8 col7">1.87</td>
      <td id="T_c4106_row8_col8" class="data row8 col8">7.59</td>
    </tr>
    <tr>
      <td id="T_c4106_row9_col0" class="data row9 col0">2025_Q2</td>
      <td id="T_c4106_row9_col1" class="data row9 col1">2.54</td>
      <td id="T_c4106_row9_col2" class="data row9 col2">2.39</td>
      <td id="T_c4106_row9_col3" class="data row9 col3">23215.00</td>
      <td id="T_c4106_row9_col4" class="data row9 col4">21815.00</td>
      <td id="T_c4106_row9_col5" class="data row9 col5">9.69</td>
      <td id="T_c4106_row9_col6" class="data row9 col6">9.00</td>
      <td id="T_c4106_row9_col7" class="data row9 col7">1.79</td>
      <td id="T_c4106_row9_col8" class="data row9 col8">5.83</td>
    </tr>
    <tr>
      <td id="T_c4106_row10_col0" class="data row10 col0">2025_Q3</td>
      <td id="T_c4106_row10_col1" class="data row10 col1">3.45</td>
      <td id="T_c4106_row10_col2" class="data row10 col2">3.24</td>
      <td id="T_c4106_row10_col3" class="data row10 col3">25590.00</td>
      <td id="T_c4106_row10_col4" class="data row10 col4">24050.00</td>
      <td id="T_c4106_row10_col5" class="data row10 col5">10.07</td>
      <td id="T_c4106_row10_col6" class="data row10 col6">9.30</td>
      <td id="T_c4106_row10_col7" class="data row10 col7">1.95</td>
      <td id="T_c4106_row10_col8" class="data row10 col8">8.72</td>
    </tr>
    <tr>
      <td id="T_c4106_row11_col0" class="data row11 col0">2025_Q4</td>
      <td id="T_c4106_row11_col1" class="data row11 col1">3.41</td>
      <td id="T_c4106_row11_col2" class="data row11 col2">3.33</td>
      <td id="T_c4106_row11_col3" class="data row11 col3">19275.00</td>
      <td id="T_c4106_row11_col4" class="data row11 col4">18815.00</td>
      <td id="T_c4106_row11_col5" class="data row11 col5">43.49</td>
      <td id="T_c4106_row11_col6" class="data row11 col6">42.17</td>
      <td id="T_c4106_row11_col7" class="data row11 col7">1.70</td>
      <td id="T_c4106_row11_col8" class="data row11 col8">8.31</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>The strategy delivers consistently positive gross and net Sharpe ratios across most quarters, with strong cumulative returns and positive net PnL after costs. Performance is particularly strong in selected periods, while drawdowns and trading activity remain controlled, indicating a robust and repeatable volatility-breakout approach.</p>
</section>
<section id="equity-line-for-group-2-2023q1" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2023q1">Equity line for <strong>group 2</strong> – 2023Q1</h2>
<div class="cell" data-execution_count="72">
<div class="cell-output cell-output-display" data-execution_count="72">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-73-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Little volatility in the first half of the quarter. However, later steady, growing trend indicates profitable strategy.</p>
</section>
<section id="equity-line-for-group-2-2023q2" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2023q2">Equity line for <strong>group 2</strong> – 2023Q2</h2>
<div class="cell" data-execution_count="73">
<div class="cell-output cell-output-display" data-execution_count="73">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-74-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The equity line shows a deep early drawdown followed by a strong mid- to late-quarter recovery, resulting in a positive outcome but with elevated volatility.</p>
</section>
<section id="equity-line-for-group-2-2023q3" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2023q3">Equity line for <strong>group 2</strong> – 2023Q3</h2>
<div class="cell" data-execution_count="74">
<div class="cell-output cell-output-display" data-execution_count="74">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-75-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Strategy started off strong - quick increase of both gross and net PnL. Little gap between gross and net PnL means low total transaction costs.</p>
</section>
<section id="equity-line-for-group-2-2023q4" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2023q4">Equity line for <strong>group 2</strong> – 2023Q4</h2>
<div class="cell" data-execution_count="75">
<div class="cell-output cell-output-display" data-execution_count="75">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-76-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Slow start with balancing on the profitability edge. Later, followed by rapid increase and steady end of the quarter.</p>
</section>
<section id="equity-line-for-group-2-2024q1" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2024q1">Equity line for <strong>group 2</strong> – 2024Q1</h2>
<div class="cell" data-execution_count="76">
<div class="cell-output cell-output-display" data-execution_count="76">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-77-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here we can see strong profitability with multiple peaks, but increased volatility toward the end of the quarter leads to partial profit erosion, highlighting a trade-off between high returns and drawdowns.</p>
</section>
<section id="equity-line-for-group-2-2024q2" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2024q2">Equity line for <strong>group 2</strong> – 2024Q2</h2>
<div class="cell" data-execution_count="77">
<div class="cell-output cell-output-display" data-execution_count="77">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-78-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Steady increase in both gross and net PnL, indicating stable startegy. Little gap between the lines shows low total transaction costs (low trade number). Peak PnL at $30,000.</p>
</section>
<section id="equity-line-for-group-2-2024q3" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2024q3">Equity line for <strong>group 2</strong> – 2024Q3</h2>
<div class="cell" data-execution_count="78">
<div class="cell-output cell-output-display" data-execution_count="78">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-79-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Performance in 2024Q3 is characterized by a strong and steady upward trajectory, with limited drawdowns and a narrow gap between gross and net PnL, indicating efficient execution and robust profitability.</p>
</section>
<section id="equity-line-for-group-2-2024q4" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2024q4">Equity line for <strong>group 2</strong> – 2024Q4</h2>
<div class="cell" data-execution_count="79">
<div class="cell-output cell-output-display" data-execution_count="79">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-80-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Strong, upward trade with little volatility. Gross and net PnL lines close togetger, indicating low tota transaction costs.</p>
</section>
<section id="equity-line-for-group-2-2025q1" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2025q1">Equity line for <strong>group 2</strong> – 2025Q1</h2>
<div class="cell" data-execution_count="80">
<div class="cell-output cell-output-display" data-execution_count="80">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-81-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Strong, upward trend with high volatility in second half of the quarter. Ending culmulative net PnL strong at more that $20,000.</p>
</section>
<section id="equity-line-for-group-2-2025q2" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2025q2">Equity line for <strong>group 2</strong> – 2025Q2</h2>
<div class="cell" data-execution_count="81">
<div class="cell-output cell-output-display" data-execution_count="81">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-82-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Highly volatile results - slow start with losing startegy in the middle of the period, turning into positive final cumulative net PnL. Slow growth of the gap between gross and net PnL.</p>
</section>
<section id="equity-line-for-group-2-2025q3" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2025q3">Equity line for <strong>group 2</strong> – 2025Q3</h2>
<div class="cell" data-execution_count="82">
<div class="cell-output cell-output-display" data-execution_count="82">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-83-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>performance is highly volatile, marked by a deep mid-quarter drawdown followed by a sharp late-period rebound, indicating unstable behavior but strong recovery potential</p>
</section>
<section id="equity-line-for-group-2-2025q4" class="level2">
<h2 class="anchored" data-anchor-id="equity-line-for-group-2-2025q4">Equity line for <strong>group 2</strong> – 2025Q4</h2>
<div class="cell" data-execution_count="83">
<div class="cell-output cell-output-display" data-execution_count="83">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="final_report%20(1)_files/figure-html/cell-84-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>the equity curve shows an initial drawdown followed by a strong and consistent recovery, ending the quarter with solid positive performance and improved stability compared to the previous period</p>
</section>
<section id="summary-and-conclusions" class="level2">
<h2 class="anchored" data-anchor-id="summary-and-conclusions">Summary and conclusions</h2>
<p>This project focused on the design and evaluation of intraday trading strategies based on technical indicators, including momentum and mean-reversion approaches, applied to high-frequency market data. The strategies were tested across multiple quarterly periods using realistic trading constraints such as restricted trading hours, flat-position rules around session boundaries, and transaction cost modeling.</p>
<p>Strategy performance was assessed using profit and loss (PnL), Sharpe ratios, and Calmar ratios computed from returns normalized by traded notional exposure, avoiding arbitrary capital assumptions. A daily stop-loss mechanism was introduced to limit downside risk and control large intraday losses. The implementation of stop-loss condition had the biggest impact on the results, making the strategies profitable. The stop-loss significantly improved drawdown behavior and return stability, turning otherwise unstable strategies into consistently profitable ones.</p>
<p>Overall, the results highlight that effective risk management and execution rules are as important as signal generation itself, and that simple technical strategies can achieve robust performance when complemented by disciplined stop-loss controls.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>